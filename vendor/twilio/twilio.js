(function e$$0(m,h,a){function b(e,f){if(!h[e]){if(!m[e]){var l="function"==typeof require&&require;if(!f&&l)return l(e,!0);if(d)return d(e,!0);l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l;}l=h[e]={exports:{}};m[e][0].call(l.exports,function(a){var k=m[e][1][a];return b(k?k:a)},l,l.exports,e$$0,m,h,a)}return h[e].exports}for(var d="function"==typeof require&&require,e=0;e<a.length;e++)b(a[e]);return b})({1:[function(g,m,h){Twilio=function(a){var b=a||function(){};(function(a){for(var e in a)b[e]=
a[e]})(function(){var a=g("./twilio/util");a.getSDKVersion();var b;if("undefined"==typeof b){b="http:";for(var c="//static.twilio.com/libs/twiliojs/refs/e834255/",f=document.getElementsByTagName("script"),l=/(\w+:)?(\/\/.*)(twilio.min.js|twilio.js)/,v=0;v<f.length;v++){var k=f[v].src.match(l);if(k){b=k[1]||b;c=k[2];break}}b+=c}a.setTwilioRoot(b);return g("./twilio")}());return b}("undefined"!==typeof Twilio?Twilio:null)},{"./twilio":2,"./twilio/util":18}],2:[function(g,m,h){h.Device=g("./twilio/device").Device;
h.PStream=g("./twilio/pstream").PStream;h.Connection=g("./twilio/connection").Connection},{"./twilio/connection":3,"./twilio/device":4,"./twilio/pstream":8}],3:[function(g,m,h){function a(f,k,d){function p(){}if(!(this instanceof a))return new a(f,k,d);e.monitorEventEmitter("Twilio.Connection",this);this.device=f;this.message=k||{};d=d||{};f={logPrefix:"[Connection]",mediaStreamFactory:l.PeerConnection,offerSdp:null,debug:!1,encrypt:!1,audioConstraints:f.options.audioConstraints,rtcConstraints:f.options.rtcConstraints};
for(var w in f)w in d||(d[w]=f[w]);this.options=d;this.parameters={};this._status=this.options.offerSdp?"pending":"closed";this.sendHangup=!0;c.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;this.log.warnings=this.options.warnings;this._onHangup=this._onCancel=p;this._onAnswer=function(a){"undefined"!==typeof a.callsid&&(t.parameters.CallSid=a.callsid,t.mediaStream.callSid=a.callsid)};this.mediaStream=new this.options.mediaStreamFactory(this.options.encrypt,this.device);
var t=this;this.mediaStream.onerror=function(a){!0===a.disconnect&&t.disconnect(a.info&&a.info.message);var b={code:a.info.code,message:a.info.message||"Error with mediastream",info:a.info,connection:t};t.log("Received an error from MediaStream:",a);t.emit("error",b)};this.mediaStream.onopen=function(){"open"!==t._status&&("connecting"===t._status?(t._status="open",t.mediaStream.attachAudio(),t.emit("accept",t)):t.mediaStream.close())};this.mediaStream.onclose=function(){t._status="closed";t.device.sounds.disconnect()&&
t.device.soundcache.play("disconnect");t.emit("disconnect",t)};this.pstream=this.device.stream;this._onCancel=function(a){t.parameters.CallSid==a.callsid&&(t.ignore(),t.pstream.removeListener("cancel",t._onCancel))};this.pstream&&this.pstream.addListener("cancel",this._onCancel);this.on("error",function(){t.pstream&&"disconnected"===t.pstream.status&&b(t)});this.on("disconnect",function(){b(t)});return this}function b(a){function b(){a.pstream.removeListener("answer",a._onAnswer);a.pstream.removeListener("cancel",
a._onCancel);a.pstream.removeListener("hangup",a._onHangup)}b();setTimeout(b,0)}m=g("events").EventEmitter;var d=g("util"),e=g("./util"),c=g("./log"),f=g("./util").Exception,l=g("./rtc");d.inherits(a,m);a.toString=function(){return"[Twilio.Connection class]"};a.prototype.toString=function(){return"[Twilio.Connection instance]"};a.prototype.sendDigits=function(a){if(a.match(/[^0-9*#w]/))throw new f("Illegal character passed into sendDigits");for(var b=[],e=0;e<a.length;e++){var c="w"!=a[e]?"dtmf"+
a[e]:"";"dtmf*"==c&&(c="dtmfs");"dtmf#"==c&&(c="dtmfh");b.push([c,200,20])}this.device.soundcache.playseq(b);var w=this.mediaStream.getOrCreateDTMFSender();if(w){if(w.canInsertDTMF){var d=function(){var a=l.shift();a.length&&w.insertDTMF(a,160,70);l.length&&setTimeout(d,500)};this.log("Sending digits using RTCDTMFSender");var l=a.split("w");l.length&&d();return}this.log("RTCDTMFSender cannot insert DTMF")}this.log("Sending digits over PStream");null!=this.pstream&&"disconnected"!=this.pstream.status?
(a={dtmf:a,callsid:this.parameters.CallSid},this.pstream.publish("dtmf",a)):(a={error:{}},this.emit("error",{code:a.error.code||31E3,message:a.error.message||"Could not send DTMF: Signaling channel is disconnected",connection:this}))};a.prototype.status=function(){return this._status};a.prototype.mute=function(a){0===arguments.length&&this.log.deprecated(".mute() is deprecated. Please use .mute(true) or .mute(false) to mute or unmute a call instead.");if("function"==typeof a)return this.addListener("mute",
a);var b=this.isMuted(),e=this,c=function(){var a=e.isMuted();b!=a&&e.emit("mute",a,e)};0==a?this.mediaStream.attachAudio(c):this.mediaStream.detachAudio(c)};a.prototype.isMuted=function(){return!this.mediaStream.isAudioAttached()};a.prototype.unmute=function(){this.log.deprecated(".unmute() is deprecated. Please use .mute(false) to unmute a call instead.");this.mute(!1)};a.prototype.accept=function(a){if("function"==typeof a)return this.addListener("accept",a);a=a||this.options.audioConstraints;
var c=this;this._status="connecting";this.mediaStream.openHelper(function(a,f){if("connecting"!=c._status)b(c),c.mediaStream.close();else if(a)c._die(a,f);else{var w=[],d;for(d in c.message)w.push(encodeURIComponent(d)+"="+encodeURIComponent(c.message[d]));w=w.join("&");c.parameters.CallSid?c.mediaStream.answerIncomingCall.call(c.mediaStream,c.parameters.CallSid,c.options.offerSdp,c.options.rtcConstraints):(c.outboundConnectionId=e.generateConnectionUUID(),c.mediaStream.makeOutgoingCall.call(c.mediaStream,
w,c.outboundConnectionId,c.options.rtcConstraints),c.pstream.once("answer",c._onAnswer));c._onHangup=function(a){if(a.callsid&&(c.parameters.CallSid||c.outboundConnectionId)){if(a.callsid!=c.parameters.CallSid&&a.callsid!=c.outboundConnectionId)return}else if(a.callsid)return;c.log("Received HANGUP from gateway");a.error&&(a={code:a.error.code||31E3,message:a.error.message||"Error sent from gateway in HANGUP",connection:c},c.log("Received an error from the gateway:",a),c.emit("error",a));c.sendHangup=
!1;c.disconnect();b(c)};c.pstream.addListener("hangup",c._onHangup)}},a)};a.prototype.reject=function(a){if("function"==typeof a)return this.addListener("reject",a);"pending"==this._status&&(this.pstream.publish("reject",{callsid:this.parameters.CallSid}),this.emit("reject"))};a.prototype.ignore=function(a){if("function"==typeof a)return this.addListener("cancel",a);"pending"==this._status&&(this._status="closed",this.emit("cancel"))};a.prototype.cancel=function(a){this.log.deprecated(".cancel() is deprecated. Please use .ignore() instead.");
this.ignore(a)};a.prototype.disconnect=function(a){if("function"==typeof a)return this.addListener("disconnect",a);a="string"===typeof a?a:null;if("open"==this._status||"connecting"==this._status){this.log("Disconnecting...");if(null!=this.pstream&&"disconnected"!=this.pstream.status&&this.sendHangup){var c=this.parameters.CallSid||this.outboundConnectionId;c&&(c={callsid:c},a&&(c.message=a),this.pstream.publish("hangup",c))}b(this);this.mediaStream.close()}};a.prototype.error=function(a){if("function"==
typeof a)return this.addListener("error",a)};a.prototype._die=function(a,c){this.emit("error",{message:a,code:c});this.disconnect()};h.Connection=a},{"./log":6,"./rtc":11,"./util":18,events:24,util:28}],4:[function(g,m,h){function a(b,d){if(!f.enabled())throw new c.Exception("twilio.js 1.3 requires WebRTC/ORTC browser support. For more information, see <https://www.twilio.com/docs/api/client/twilio-js>. If you have any questions about this announcement, please contact Twilio Support at <help@twilio.com>.");
if(!(this instanceof a))return new a(b,d);c.monitorEventEmitter("Twilio.Device",this);if(!b)throw new c.Exception("Capability token is not valid or missing.");for(i in d);var u={logPrefix:"[Device]",host:"chunder.twilio.com",chunderw:"chunderw-vpc-gll.twilio.com",eventgw:"eventgw.twilio.com",soundCacheFactory:k,soundFactory:v,connectionFactory:x,pStreamFactory:p,noRegister:!1,encrypt:!1,closeProtection:!1,secureSignaling:!0,warnings:!0,audioConstraints:!0,chrome3940Workaround:!1,region:"gll",dscp:!0};
d=d||{};var g=d.chunderw,h;for(h in u)h in d||(d[h]=u[h]);d.rtcConstraints=d.dscp?{optional:[{googDscp:!0}]}:{};u=c.objectize(b);this._accountSid=u.iss;this._clientName=u.scope["client:incoming"]?u.scope["client:incoming"].params.clientName:null;this.options=d;this.token=b;this._region=this._status="offline";this.connections=[];this.sounds=new l({incoming:!0,outgoing:!0,disconnect:!0});u={gll:"chunderw-vpc-gll.twilio.com","gll-classic":"chunderw-gll.twilio.com",au:"chunderw-vpc-gll-au1.twilio.com",
br:"chunderw-vpc-gll-br1.twilio.com",ie:"chunderw-vpc-gll-ie1.twilio.com",jp:"chunderw-vpc-gll-jp1.twilio.com",sg:"chunderw-vpc-gll-sg1.twilio.com","us-or":"chunderw-vpc-gll-us2.twilio.com","us-va":"chunderw-vpc-gll-us1.twilio.com"};h=d.region.toLowerCase();if(!(h in u))throw new c.Exception("Region "+d.region+" is invalid. Valid values are: "+Object.keys(u).join(", "));d.chunderw=g||u[h];this.soundcache=this.options.soundCacheFactory();g="undefined"===typeof document?{}:document.createElement("audio");
canPlayMp3=!1;try{canPlayMp3=!(!g.canPlayType||!g.canPlayType("audio/mpeg").replace(/no/,""))}catch(z){}canPlayVorbis=!1;try{canPlayVorbis=!(!g.canPlayType||!g.canPlayType('audio/ogg;codecs="vorbis"').replace(/no/,""))}catch(r){}g="mp3";canPlayVorbis&&!canPlayMp3&&(g="ogg");var g={incoming:"sounds/incoming."+g,outgoing:"sounds/outgoing."+g,disconnect:"sounds/disconnect."+g,dtmf1:"sounds/dtmf-1."+g,dtmf2:"sounds/dtmf-2."+g,dtmf3:"sounds/dtmf-3."+g,dtmf4:"sounds/dtmf-4."+g,dtmf5:"sounds/dtmf-5."+g,
dtmf6:"sounds/dtmf-6."+g,dtmf7:"sounds/dtmf-7."+g,dtmf8:"sounds/dtmf-8."+g,dtmf9:"sounds/dtmf-9."+g,dtmf0:"sounds/dtmf-0."+g,dtmfs:"sounds/dtmf-star."+g,dtmfh:"sounds/dtmf-hash."+g},u=c.getTwilioRoot(),B;for(B in g)h=this.options.soundFactory(),h.load(u+g[B]),this.soundcache.add(B,h);this.soundcache.envelope("incoming",{release:2E3});e.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;var n=this;this.addListener("incoming",function(a){a.once("accept",function(){n.soundcache.stop("incoming")});
a.once("cancel",function(){n.soundcache.stop("incoming")});a.once("error",function(){n.soundcache.stop("incoming")});a.once("reject",function(){n.soundcache.stop("incoming")});n.sounds.incoming()&&n.soundcache.play("incoming",0,1E3)});this.mediaPresence={audio:!this.options.noRegister};this.register(this.token);var q=this.options.closeProtection;q&&(B=function(a){if("busy"==n._status){var c=1==q?"A call is currently in-progress. Leaving or reloading this page will end the call.":q;return(a||window.event).returnValue=
c}},"undefined"!==typeof window&&(window.addEventListener?window.addEventListener("beforeunload",B):window.attachEvent&&window.attachEvent("onbeforeunload",B)));B=function(){n.disconnectAll()};"undefined"!==typeof window&&(window.addEventListener?window.addEventListener("unload",B):window.attachEvent&&window.attachEvent("onunload",B));this.on("error",function(){});return this}function b(a,c,b){var e={encrypt:a.options.encrypt,debug:a.options.debug,warnings:a.options.warnings};b=b||{};for(var d in e)d in
b||(b[d]=e[d]);var f=a.options.connectionFactory(a,c,b);f.once("accept",function(){a._status="busy";a.emit("connect",f)});f.addListener("error",function(c){a.emit("error",c);"pending"==f.status()&&"connecting"==f.status()&&a._removeConnection(f)});f.once("cancel",function(){a.log("Canceled: "+f.parameters.CallSid);a._removeConnection(f);a.emit("cancel",f)});f.once("disconnect",function(){"busy"==a._status&&(a._status="ready");a.emit("disconnect",f);a._removeConnection(f)});f.once("reject",function(){a.log("Rejected: "+
f.parameters.CallSid);a._removeConnection(f)});return f}m=g("events").EventEmitter;var d=g("util"),e=g("./log"),c=g("./util"),f=g("./rtc"),l=g("./options").Options,v=g("./sound").Sound,k=g("./soundcache").SoundCache,x=g("./connection").Connection,p=g("./pstream").PStream;d.inherits(a,m);c.mixinGetMediaEngine(a.prototype);a.toString=function(){return"[Twilio.Device class]"};a.prototype.toString=function(){return"[Twilio.Device instance]"};a.prototype.register=function(a){this.stream&&"disconnected"!=
this.stream.status?this.stream.setToken(a):this._setupStream()};a.prototype.registerPresence=function(){this.token&&(c.objectize(this.token).scope["client:incoming"]&&(this.mediaPresence.audio=!0),this._sendPresence())};a.prototype.unregisterPresence=function(){this.mediaPresence.audio=!1;this._sendPresence()};a.prototype.connect=function(a,c){if("function"==typeof a)return this.addListener("connect",a);a=a||{};c=c||this.options.audioConstraints;var e=b(this,a);this.connections.push(e);if(this.sounds.outgoing()){var d=
this;e.accept(function(){d.soundcache.play("outgoing")})}e.accept(c);return e};a.prototype.disconnectAll=function(){for(var a=[].concat(this.connections),c=0;c<a.length;c++)a[c].disconnect();0<this.connections.length&&this.log("Connections left pending: "+this.connections.length)};a.prototype.destroy=function(){this.stream&&(this.stream.destroy(),this.stream=null)};a.prototype.disconnect=function(a){this.addListener("disconnect",a)};a.prototype.incoming=function(a){this.addListener("incoming",a)};
a.prototype.offline=function(a){this.addListener("offline",a)};a.prototype.ready=function(a){this.addListener("ready",a)};a.prototype.error=function(a){this.addListener("error",a)};a.prototype.status=function(){return this._status};a.prototype.activeConnection=function(){return this.connections[0]};a.prototype.region=function(){return this._region};a.prototype._sendPresence=function(){this.stream.register(this.mediaPresence);this.mediaPresence.audio?this._startRegistrationTimer():this._stopRegistrationTimer()};
a.prototype._startRegistrationTimer=function(){clearTimeout(this.regTimer);var a=this;this.regTimer=setTimeout(function(){a._sendPresence()},3E4)};a.prototype._stopRegistrationTimer=function(){clearTimeout(this.regTimer)};a.prototype._setupStream=function(){var a=this;this.log("Setting up PStream");this.stream=this.options.pStreamFactory(this.token,{chunder:this.options.host,chunderw:this.options.chunderw,debug:this.options.debug,secureSignaling:this.options.secureSignaling});this.stream.addListener("connected",
function(c){a._region={US_EAST_VIRGINIA:"us-va",US_WEST_OREGON:"us-or",ASIAPAC_SYDNEY:"au",SOUTH_AMERICA_SAO_PAULO:"br",EU_IRELAND:"ie",ASIAPAC_TOKYO:"jp",ASIAPAC_SINGAPORE:"sg"}[c.region]||c.region;a._sendPresence()});this.stream.addListener("ready",function(){a.log("Stream is ready");"offline"==a._status&&(a._status="ready");a.emit("ready",a)});this.stream.addListener("offline",function(){a.log("Stream is offline");a._status="offline";a._region="offline";a.emit("offline",a)});this.stream.addListener("error",
function(c){var b=c.error;b&&(c.callsid&&(b.connection=a._findConnection(c.callsid)),31205===b.code&&a._stopRegistrationTimer(),a.log("Received error: ",b),a.emit("error",b))});this.stream.addListener("invite",function(c){if("busy"==a._status)a.log("Device busy; ignoring incoming invite");else if(c.callsid&&c.sdp){var e=b(a,{},{offerSdp:c.sdp});e.parameters=c.parameters||{};e.parameters.CallSid=e.parameters.CallSid||c.callsid;a.connections.push(e);a.emit("incoming",e)}else a.emit("error",{message:"Malformed invite from gateway"})})};
a.prototype._removeConnection=function(a){for(var c=this.connections.length-1;0<=c;c--)a==this.connections[c]&&this.connections.splice(c,1)};a.prototype._findConnection=function(a){for(var c=0;c<this.connections.length;c++){var b=this.connections[c];if(b.parameters.CallSid==a||b.outboundConnectionId==a)return b}};a=function(b){var e=[],d=[],f=function(a){if(b.instance)return a();d.push(a)},k=function(a){a=(a.code?a.code+": ":"")+a.message;if(b.instance){for(var n=0,q=b.instance.listeners("error"),
e=0;e<q.length;e++)q[e]!==k&&n++;if(1<n)return;b.instance.log(a)}throw new c.Exception(a);},l={instance:null,setup:function(c,n){if(b.instance)b.instance.log("Found existing Device; using new token but ignoring options"),b.instance.token=c,b.instance.register(c);else{b.instance=new a(c,n);b.error(k);b.sounds=b.instance.sounds;for(var q=0;q<d.length;q++)d[q]();d=[]}for(q=0;q<e.length;q++)e[q](c,n);e=[];return b},connect:function(a,n){if("function"==typeof a)f(function(){b.instance.addListener("connect",
a)});else{if(!b.instance)throw new c.Exception("Run Twilio.Device.setup()");if(0<b.instance.connections.length)b.instance.emit("error",{message:"A connection is currently active"});else return b.instance.connect(a,n)}},disconnectAll:function(){f(function(){b.instance.disconnectAll()});return b},disconnect:function(a){f(function(){b.instance.addListener("disconnect",a)});return b},status:function(){if(!b.instance)throw new c.Exception("Run Twilio.Device.setup()");return b.instance.status()},region:function(){if(!b.instance)throw new c.Exception("Run Twilio.Device.setup()");
return b.instance.region()},ready:function(a){f(function(){b.instance.addListener("ready",a)});return b},error:function(a){f(function(){a!=k&&b.instance.removeListener("error",k);b.instance.addListener("error",a)});return b},offline:function(a){f(function(){b.instance.addListener("offline",a)});return b},incoming:function(a){f(function(){b.instance.addListener("incoming",a)});return b},destroy:function(){b.instance&&b.instance.destroy();return b},cancel:function(a){f(function(){b.instance.addListener("cancel",
a)});return b},activeConnection:function(){return b.instance?b.instance.activeConnection():null}},r;for(r in l)b[r]=l[r];b.getMediaEngine=function(){return b.instance?b.instance.getMediaEngine():c.getMediaEngine()};b.getMediaEngine.ORTC=c.getMediaEngine.ORTC;b.getMediaEngine.WEBRTC=c.getMediaEngine.WEBRTC;return b}(a);h.Device=a},{"./connection":3,"./log":6,"./options":7,"./pstream":8,"./rtc":11,"./sound":15,"./soundcache":16,"./util":18,events:24,util:28}],5:[function(g,m,h){function a(b){if(!(this instanceof
a))return new a(b);b=b||{};var d=function(){},d={interval:10,now:function(){return(new Date).getTime()},repeat:function(a,b){return setInterval(a,b)},stop:function(a,b){return clearInterval(a,b)},onsleep:d,onwakeup:d},e;for(e in d)e in b||(b[e]=d[e]);this.interval=b.interval;this.lastbeat=0;this.pintvl=null;this.onsleep=b.onsleep;this.onwakeup=b.onwakeup;this.repeat=b.repeat;this.stop=b.stop;this.now=b.now}a.toString=function(){return"[Twilio.Heartbeat class]"};a.prototype.toString=function(){return"[Twilio.Heartbeat instance]"};
a.prototype.beat=function(){this.lastbeat=this.now();if(this.sleeping()){if(this.onwakeup)this.onwakeup();var a=this;this.pintvl=this.repeat.call(null,function(){a.check()},1E3*this.interval)}};a.prototype.check=function(){var a=this.now()-this.lastbeat;if(!this.sleeping()&&a>=1E3*this.interval){if(this.onsleep)this.onsleep();this.stop.call(null,this.pintvl);this.pintvl=null}};a.prototype.sleeping=function(){return null==this.pintvl};h.Heartbeat=a},{}],6:[function(g,m,h){h.mixinLog=function(a,b){function d(){if(d.enabled)for(var a=
d.prefix?d.prefix+" ":"",b=0;b<arguments.length;b++){var f=arguments[b];d.handler("string"==typeof f?a+f:f)}}d.enabled=!0;d.prefix=b||"";d.defaultHandler=function(a){"undefined"!==typeof console&&console.log(a)};d.handler=d.defaultHandler;d.warnings=!0;d.defaultWarnHandler=function(a){"undefined"!==typeof console&&("function"===typeof console.warn?console.warn(a):"function"===typeof console.log&&console.log(a))};d.warnHandler=d.defaultWarnHandler;d.deprecated=function(){if(d.warnings)for(var a=0;a<
arguments.length;a++)d.warnHandler(arguments[a])};a.log=d}},{}],7:[function(g,m,h){g=function(){function a(d,e){if(!(this instanceof a))return new a(d);this.__dict__={};d=d||{};e=e||{};for(var c in d)this[c]=b(this.__dict__,c),this[c](d[c]);for(c in e)this[c](e[c])}function b(a,b){return function(c){return"undefined"==typeof c?a[b]:a[b]=c}}return a}();h.Options=g},{}],8:[function(g,m,h){function a(b,v){if(!(this instanceof a))return new a(b,v);e.monitorEventEmitter("Twilio.PStream",this);var k={logPrefix:"[PStream]",
chunder:"chunder.twilio.com",chunderw:"chunderw-vpc-gll.twilio.com",secureSignaling:!0,transportFactory:f,debug:!1};v=v||{};for(var g in k)g in v||(v[g]=k[g]);this.options=v;this.token=b||"";this.status="disconnected";this.host=c.enabled()?this.options.chunderw:this.options.chunder;this.gateway=null;d.mixinLog(this,this.options.logPrefix);this.log.enabled=this.options.debug;this.on("error",function(){});var p=this;this.addListener("ready",function(){p.status="ready"});this.addListener("offline",function(){p.status=
"offline"});this.addListener("close",function(){p.destroy()});this.transport=this.options.transportFactory({host:this.host,debug:this.options.debug,secureSignaling:this.options.secureSignaling});this.transport.onopen=function(){p.status="connected";p.setToken(p.token)};this.transport.onclose=function(){"disconnected"!=p.status&&("offline"!=p.status&&p.emit("offline",p),p.status="disconnected")};this.transport.onerror=function(a){p.emit("error",a)};this.transport.onmessage=function(a){a=e.splitObjects(a.data);
for(var b=0;b<a.length;b++){var c=JSON.parse(a[b]),f=c.type,c=c.payload||{};c.gateway&&(p.gateway=c.gateway);p.emit(f,c)}};this.transport.open();return this}m=g("events").EventEmitter;var b=g("util"),d=g("./log"),e=g("./util"),c=g("./rtc");g("./heartbeat");var f=g("./wstransport").WSTransport;b.inherits(a,m);a.toString=function(){return"[Twilio.PStream class]"};a.prototype.toString=function(){return"[Twilio.PStream instance]"};a.prototype.setToken=function(a){this.log("Setting token and publishing listen");
this.token=a;a={token:a,browserinfo:e.getSystemInfo()};this.publish("listen",a)};a.prototype.register=function(a){this.publish("register",{media:a})};a.prototype.destroy=function(){this.log("Closing PStream");this.transport.close();return this};a.prototype.publish=function(a,b){var c=JSON.stringify({type:a,version:e.getSDKVersion(),payload:b});this.transport.send(c)};h.PStream=a},{"./heartbeat":5,"./log":6,"./rtc":11,"./util":18,"./wstransport":19,events:24,util:28}],9:[function(g,m,h){var a="undefined"===
typeof XMLHttpRequest?g("xmlhttprequest").XMLHttpRequest:XMLHttpRequest;g=function(b,d,e){var c;c=c||a;var f=new c;f.open(b,d.url,!0);f.onreadystatechange=function(){4===f.readyState&&(200<=f.status&&300>f.status?e(null,f.responseText):e(Error(f.responseText)))};for(var l in d.headers)f.setRequestHeader(l,d.headers[l]);f.send(JSON.stringify(d.body))};g.get=function(a,d){return new this("GET",a,d)};g.post=function(a,d){return new this("POST",a,d)};m.exports=g},{xmlhttprequest:43}],10:[function(g,m,
h){function a(c,e){if(!(this instanceof a))return new a(c,e);this.device=e;b.mixinLog(this,"[Twilio.Analytics]");this.log.enabled=this.device.options.debug;this.log.warnings=this.device.options.warnings;this._tag=c;this._previousStat=this._tempCallSid=null;this._eventgw=this.device.options.eventgw;return this}var b=g("../log"),d=g("../util"),e=g("../request");a.prototype.buildEventMetaData=function(a,b,c){this._tempCallSid=a.callSid&&a.callSid.match(/^TJ/)?a.callSid:this._tempCallSid;var e=d.getSystemInfo(),
g=d.detectBrowser();return{account_sid:this.device._accountSid,call_sid:a.callSid,temp_call_sid:this._tempCallSid,events:c,platform:d.getMediaEngine(a.device),gateway:b,client_name:this.device._clientName,sdk_version:e.v,browser:g?g[0]:null,browser_major_version:g?g[1]:null,platform_version:e&&e.browser?e.browser.platform:null,user_agent:e&&e.browser?e.browser.userAgent:null}};a.prototype.callEvents=function(a,b){var c={tag:this._tag,event:a,timestamp:Math.floor(new Date/1E3)};c.data=b;return c};
a.prototype.publish=function(a){var b=this;e.post({url:"https://"+b._eventgw+"/v1/EndpointEvents",body:a,headers:{"Content-Type":"application/json","X-Twilio-Token":this.device.token}},function(a,c){return a?(b.log("Failed to publish call events "+a),!1):!0})};a.prototype.calculateMosScore=function(a){if(!this._previousStat||!a)return this._previousStat=a,null;var b;try{if(a.direction==this._previousStat.direction&&a.media==this._previousStat.media&&a.packets&&this._previousStat.packets){var e=this._previousStat,
d=a.rtt?a.rtt:e.rtt,d=d?d:0,g=a.jitter?a.jitter:0,p=a.packets.recvtot-e.packets.recvtot,w=a.packets.recvlost?a.packets.recvlost:0,p=p+w,t;t=d+2*g+10;var u;e=w/p*100;u=isNaN(e)?-1:e;var h,e=0;switch(!0){case 160>t:e=c.r0-t/40;break;case 1E3>t:e=c.r0-(t-120)/10;break;case 1E3<=t:e=c.r0-t/100}t=.01;switch(!0){case -1==u:e=t=0;break;case u<=e/2.5:t=2.5;break;case u>e/2.5&&100>u:t=.25}h=e-u*t;(b=1+.035*h+7E-6*h*(h-60)*(100-h))&&(b=parseFloat(Math.round(100*b)/100).toFixed(2))}}catch(m){this.log("Exception calculating mos "+
m)}finally{return this._previousStat=a,b}};var c={r0:94.768,is:1.42611};m.exports=a},{"../log":6,"../request":9,"../util":18}],11:[function(g,m,h){var a=g("./peerconnection");m.exports={PeerConnection:g("./peerconnection"),enabled:function(b){"undefined"!==typeof b&&(a.enabled=b);return a.enabled}}},{"./peerconnection":13}],12:[function(g,m,h){function a(a,b){if("undefined"===typeof webkitRTCPeerConnection)return b(Error("This does not appear to be Chrome 38"));var c=new webkitRTCPeerConnection({iceServers:[]}),
f=new webkitRTCPeerConnection({iceServers:[]});c.addStream(a);c.createOffer(function(a){var d=new RTCSessionDescription(a);c.setLocalDescription(d,function(){f.setRemoteDescription(d,function(){f.createAnswer(function(a){var d=new RTCSessionDescription(a);f.setLocalDescription(d,function(){c.setRemoteDescription(d,function(){b(null,c)},b)},b)},b)},b)},b)},b)}var b=g("./stats");m.exports=function(d,e){function c(a,d){if(a)return f.close(),e(a);if(20===++l||0!==g)return f.close(),e(null,0!==g);if(!("audioInputLevel"in
d))return setTimeout(function(){b(f,c)},100);g+=d.audioInputLevel;setTimeout(function(){b(f,c)},100)}var f=null,l=0,g=0;a(d,function(a,d){if(a)return e(a);f=d;b(f,c)})}},{"./stats":14}],13:[function(g,m,h){function a(b,c){if(!(this instanceof a))return new a(b,c);var n=function(){};this.onclose=this.onerror=this.onopen=n;this.version=null;this.pstream=c.stream;this.stream=null;this.video="undefined"!==typeof document&&document.createElement("video");this.video.autoplay="autoplay";this.device=c;this.status=
"connecting";this._dtmfSender=this.callSid=null;this._dtmfSenderUnsupported=!1;this._sampleStatistics=this._publishStatistics=null;this._statistics=[];this._callEvents=[];this._nextTimeToPublish=Date.now();this._onAnswer=n;l.mixinLog(this,"[Twilio.PeerConnection]");this.log.enabled=this.device.options.debug;this.log.warnings=this.device.options.warnings;this.device.options.chrome3940Workaround||(z=!1);this._iceConnectionStateMachine=new w(A,"new");this._signalingStateMachine=new w(C,"stable");this._analytics=
new t("PeerConnection",this.device);return this}function b(a){return{iceconnection:a.iceConnectionState,icegathering:a.iceGatheringState,signaling:a.signalingState}}function d(a,b,n){return a._analytics.callEvents(b,n)}function e(a,b,n){if(b){var q=a._analytics.calculateMosScore(b);b.mos=q;b.client_name=a.device._clientName;a._statistics.push(b)}n&&a._callEvents.push(n);a.startPublishingStatistics()}function c(a,b){var n=a?{timestamp:a.timestamp,packets:{recvlost:a.packetsLost,recvtot:a.packetsReceived,
senttot:a.packetsSent},bytes:{recvtot:a.bytesReceived,senttot:a.bytesSent},jitter:a.jitter,rtt:a.rtt,audio:{inlvl:a.audioInputLevel,outlvl:a.audioOutputLevel}}:{};n.timestamp=n.timestamp||Math.floor(new Date/1E3);n.pc=b;return n}function f(a){"function"===typeof MediaStreamTrack.prototype.stop?("function"===typeof a.getAudioTracks?a.getAudioTracks():a.audioTracks).forEach(function(a){a.stop()}):a.stop()}var l=g("../log"),v=g("../util"),k=g("./stats"),x=g("./issue3940"),p=g("stacktrace-js"),w=g("../statemachine"),
t=g("./analytics"),u=g("ortc-adapter"),A={"new":["checking","closed"],checking:["new","connected","failed","closed","completed"],connected:["new","disconnected","completed","closed"],completed:["new","disconnected","closed","completed"],failed:["new","disconnected","closed"],disconnected:["connected","completed","failed","closed"],closed:[]},C={stable:["have-local-offer","have-remote-offer","closed"],"have-local-offer":["stable","closed"],"have-remote-offer":["stable","closed"],closed:[]},z=function(){var a=
v.detectBrowser();return a[0]===v.detectBrowser.CHROME&&36<=a[1]&&{audioConstraints:null,localStream:null}}();a.prototype.uri=function(){return this._uri};a.prototype.openHelper=function(b,c){function n(l){if(z)return y.log("Got MediaStream; starting monitor"),x(l,function(e,d){if(e)return y.log("Monitor failed; "+e),y.log("Setting local MediaStream anyway"),y.stream=l,b();if(!d){y.log("Local MediaStream is bad! Requesting new MediaStream");z.audioConstraints=null;f(l);if(0<--k)return a.getUserMedia({audio:c},
n,q);b("Error occurred while accessing microphone.",31201)}y.log("Local MediaStream appears good; saving");z.localStream=l;y.stream=l;b()});e(y,null,d(y,"getUserMedia.onSuccess",{audioConstraints:c}));y.stream=l;b()}function q(a){z&&(z.audioConstraints=null);a.code==a.PERMISSION_DENIED?(errorMsg="User denied access to microphone, or the web browser did not allow microphone access at this address.",e(y,null,d(y,"getUserMedia.onFailure",{failure:errorMsg+" (31208)"})),b(errorMsg,31208)):(errorMsg="Error occurred while accessing microphone (31201)",
e(y,null,d(y,"getUserMedia.onFailure",{failure:errorMsg,audioConstraints:c})),b("Error occurred while accessing microphone.",31201))}var y=this;if(z&&(z.audioConstraints=z.audioConstraints||c,v.deepEqual(z.audioConstraints,c)||(console.warn("Due to a bug in Chrome 38, only the first set of audioConstraints will take effect."),y.log("Ignoring new audioConstraints: "+JSON.stringify(c)),y.log("Reusing existing audioConstraints: "+JSON.stringify(c))),z.localStream)){y.log("Reusing local MediaStream");
y.stream=z.localStream;b();return}a.getUserMedia({audio:c},n,q);var k=10};a.prototype._setupPeerConnection=function(d){var f=a.protocol;f.create(this.log,d);f.pc.addStream(this.stream);var n=this;f.pc.onaddstream=function(a){"undefined"!==typeof n.video.srcObject?n.video.srcObject=a.stream:"undefined"!==typeof n.video.mozSrcObject?n.video.mozSrcObject=a.stream:"undefined"!==typeof n.video.src?n.video.src=(window.URL||window.webkitURL).createObjectURL(a.stream):n.log("Error attaching stream to element.");
var d=c(null,b(f.pc)),k={};a.stream&&(k.active=a.stream.active,k.id=a.stream.id,a="function"===typeof a.stream.getAudioTracks?a.stream.getAudioTracks():a.stream.audioTracks,k.tracks=a.map(function(a){return{enabled:a.enabled,id:a.id,kind:a.kind,label:a.label,muted:a.muted,readonly:a.readonly,readyState:a.readyState,remote:a.remote}}));d.pc.onaddstream=k;e(n,d)};return f};a.prototype._setupChannel=function(){var a=this,f=this.version.pc;a.version.pc.onopen=function(){a.status="open";a.onopen()};a.version.pc.onstatechange=
function(n){a.version.pc&&"stable"==a.version.pc.readyState&&(a.status="open",a.onopen())};a.version.pc.onsignalingstatechange=function(n){n=f.signalingState;a.log('signalingState is "'+n+'"');var q=c(null,b(f));e(a,q,d(a,"PeerConnection.onsignalingstatechange",{iceSignalingState:f.signalingState}));try{a._signalingStateMachine.transition(n)}catch(y){q=c(null,b(f)),q.pc.invalidsignalingtransition=y.message,e(a,q)}a.version.pc&&"stable"==a.version.pc.signalingState&&(a.status="open",a.onopen())};f.onicecandidate=
function(n){var q=n.candidate||"end-of-candidates",y=c(null,b(f));y.pc.oncandidate=q;e(a,y,d(a,"PeerConnection.onicecandidate",{iceCandidate:n.candidate}))};f.oniceconnectionstatechange=function(){var n=f.iceConnectionState,q='iceConnectionState is "'+n+'"',y=c(null,b(f));e(a,y,d(a,"PeerConnection.oniceconnectionstatechange",{iceConnectionState:f.iceConnectionState}));try{a._iceConnectionStateMachine.transition(n)}catch(k){y=c(null,b(f)),y.pc.invalidiceconnectiontransition=k.message,e(a,y)}y=null;
switch(n){case "disconnected":y="ICE liveness checks failed. May be having trouble connecting to Twilio.";case "failed":n="failed"===n;a.log(q+(n?"; disconnecting":""));a.onerror({info:{code:31003,message:y||"ICE negotiation with Twilio failed. Call will terminate."},disconnect:n});break;default:a.log(q)}}};a.prototype._initializeMediaStream=function(a){if("open"==this.status)return!1;if("disconnected"==this.pstream.status)return this.onerror({info:{code:31E3,message:"Cannot establish connection. Client is disconnected"}}),
this.close(),!1;this.version=this._setupPeerConnection(a);this._setupChannel();return!0};a.prototype.makeOutgoingCall=function(a,b,n){if(this._initializeMediaStream(n)){var q=this;this.callSid=b;var c=function(){},e=function(a){q.onerror({info:{code:31E3,message:"Error processing answer: "+(a.message||a)}})};this._onAnswer=function(a){"closed"!=q.status&&q.version.processAnswer(a.sdp,c,e)};this.pstream.once("answer",this._onAnswer);this.version.createOffer({audio:!0},function(){"closed"!=q.status&&
(q.pstream.publish("invite",{sdp:q.version.getSDP(),callsid:q.callSid,twilio:{accountsid:q.device.token?v.objectize(q.device.token).iss:null,params:a}}),q.startSamplingStatistics())},function(a){q.onerror({info:{code:31E3,message:"Error creating the offer: "+(a.message||a)}})})}};a.prototype.answerIncomingCall=function(a,b,n){if(this._initializeMediaStream(n)){this.callSid=a;var q=this;this.version.processSDP(b,{audio:!0},function(){"closed"!=q.status&&(q.pstream.publish("answer",{callsid:a,sdp:q.version.getSDP()}),
q.startSamplingStatistics())},function(a){q.onerror({info:{code:31E3,message:"Error creating the answer: "+(a.message||a)}})})}};a.prototype.close=function(){this.stopSamplingStatistics();if(this.version&&this.version.pc){var a;"closed"!==this.version.pc.signalingState?(a="client",this.version.pc.close()):a="unknown";var k=c(null,b(this.version.pc));k.pc.whoclosed=a;try{k.pc.stacktraceonclose=p().map(function(a){return a.toString()}).join("\n")}catch(n){k.pc.stacktraceoncloseerror=n?n.message:null}k.pc.signalingtransitions=
this._signalingStateMachine.transitions.map(function(a){return a.from});k.pc.iceconnectiontransitions=this._iceConnectionStateMachine.transitions.map(function(a){return a.from});e(this,k,d(this,"PeerConnection.close",{whoClosed:a}));this.version.pc=null}this.stream&&(z||f(this.stream),this.stream=null);this.pstream&&this.pstream.removeListener("answer",this._onAnswer);this.video.src="";this.status="closed";this.onclose()};a.prototype.attachAudio=function(a){this.stream&&(("function"===typeof this.stream.getAudioTracks?
this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled=!0);a&&"function"==typeof a&&a()};a.prototype.detachAudio=function(a){this.stream&&(("function"===typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled=!1);a&&"function"==typeof a&&a()};a.prototype.isAudioAttached=function(){return this.stream?("function"===typeof this.stream.getAudioTracks?this.stream.getAudioTracks():this.stream.audioTracks)[0].enabled:!1};a.prototype.startPublishingStatistics=
function(){if(!this._publishStatistics){var a=this,b=Math.max(this._nextTimeToPublish-Date.now(),0);this._publishStatistics=setTimeout(function(){a._publishStatistics=null;var n=a.pstream,b=a.callSid;if(b&&"disconnected"!==n.status){var c=a._statistics.splice(0);c.length&&n.publish("meta",{callsid:b,quality:c})}a._callEvents&&(b=a._callEvents.splice(0),b.length&&(n=a._analytics.buildEventMetaData(a,n.gateway,b),a._analytics.publish(n)));a._nextTimeToPublish+=1E4},b)}};a.prototype.stopSamplingStatistics=
function(){clearInterval(this._sampleStatistics);this._sampleStatistics=null};a.prototype.startSamplingStatistics=function(){this.stopSamplingStatistics();var a=this;this._sampleStatistics=setInterval(function(){var d=b(a.version.pc);k(a.version.pc,function(n,b){n?a.stopSamplingStatistics():(b=c(b,d),e(a,b))})},1E3)};a.getUserMedia=function(a,b,n){"undefined"!=typeof navigator&&("function"==typeof navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(a,b,n):"function"==typeof navigator.mozGetUserMedia?
navigator.mozGetUserMedia(a,b,n):"function"===typeof navigator.getUserMedia?navigator.getUserMedia(a,b,n):this.log("No getUserMedia() implementation available"))};a.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender)return this._dtmfSender;if(this._dtmfSenderUnsupported)return null;var a=this.version.pc;if(!a)return this.log("No RTCPeerConnection available to call createDTMFSender on"),null;if("function"!==typeof a.createDTMFSender)return this.log("RTCPeerConnection does not support createDTMFSender"),
this._dtmfSenderUnsupported=!0,null;for(var b=a.getLocalStreams(),n,c,e=0;e<b.length;e++)if(n=b[e],n="function"===typeof n.getAudioTracks?n.getAudioTracks():n.audioTracks,n.length){c=n[0];break}if(!c)return this.log("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null;this.log("Creating RTCDTMFSender");return this._dtmfSender=a=a.createDTMFSender(c)};g=function(){"undefined"!=typeof window&&("function"==typeof window.webkitRTCPeerConnection?this.RTCPeerConnection=
webkitRTCPeerConnection:"function"==typeof window.mozRTCPeerConnection?(this.RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate):"undefined"!==typeof RTCIceGatherer?(this.RTCPeerConnection=u.RTCPeerConnection,RTCSessionDescription=u.RTCSessionDescription,RTCIceCandidate=u.RTCIceCandidate):this.log("No RTCPeerConnection implementation available"))};g.prototype.create=function(a,b){this.log=a;this.pc=new this.RTCPeerConnection({iceServers:[]},
b)};g.prototype.createModernConstraints=function(a){if("undefined"===typeof a)return null;var b={};"undefined"!==typeof webkitRTCPeerConnection?(b.mandatory={},"undefined"!==typeof a.audio&&(b.mandatory.OfferToReceiveAudio=a.audio),"undefined"!==typeof a.video&&(b.mandatory.OfferToReceiveVideo=a.video)):("undefined"!==typeof a.audio&&(b.offerToReceiveAudio=a.audio),"undefined"!==typeof a.video&&(b.offerToReceiveVideo=a.video));return b};g.prototype.createOffer=function(a,b,n){var c=this;this.pc.createOffer(function(a){c.pc&&
c.pc.setLocalDescription(new RTCSessionDescription(a),b,n)},n,this.createModernConstraints(a))};g.prototype.createAnswer=function(a,b,n){var c=this;this.pc.createAnswer(function(a){c.pc&&c.pc.setLocalDescription(new RTCSessionDescription(a),b,n)},n,this.createModernConstraints(a))};g.prototype.processSDP=function(a,b,n,c){var e=this;this.pc.setRemoteDescription(new RTCSessionDescription({sdp:a,type:"offer"}),function(){e.createAnswer(b,n,c)},c)};g.prototype.getSDP=function(){return this.pc.localDescription.sdp};
g.prototype.processAnswer=function(a,b,n){this.pc&&this.pc.setRemoteDescription(new RTCSessionDescription({sdp:a,type:"answer"}),b,n)};g.test=function(){if("object"==typeof navigator){if(navigator.webkitGetUserMedia&&"function"==typeof window.webkitRTCPeerConnection)return!0;if(navigator.mozGetUserMedia&&"function"==typeof window.mozRTCPeerConnection){try{if("function"!==typeof(new window.mozRTCPeerConnection).getLocalStreams)return!1}catch(a){return!1}return!0}if("undefined"!==typeof RTCIceGatherer)return!0}};
g=g.test()?new g:null;a.protocol=g;a.enabled=!!a.protocol;m.exports=a},{"../log":6,"../statemachine":17,"../util":18,"./analytics":10,"./issue3940":12,"./stats":14,"ortc-adapter":29,"stacktrace-js":41}],14:[function(g,m,h){function a(a,d){var f=[],l=[];a.result().forEach(function(a){var c=null;switch(a.type){case "googCandidatePair":a:{for(var c={},d={},k=a.names(),g=a.timestamp?Math.floor(a.timestamp/1E3):null,w=0;w<k.length;w++){var B=k[w],n=a.stat(B);switch(B){case "googActiveConnection":if("true"!==
n){c=null;break a}break;case "googLocalAddress":c.localAddress=n;break;case "googRemoteAddress":c.remoteAddress=n;break;case "googRtt":c.rtt=Number(n);break;case "":break;default:d[B]=n}}c.timestamp=g;c=e(c,d)}break;case "ssrc":c=b(a);break;default:l.push(a)}c&&f.push(c)});if(0===f.length||0===(f=c(f)).length)return d(null,{});var g=f.reduceRight(function(a,b){for(var c in b)a[c]=b[c];return a},{});d(null,g)}function b(a){var b={},c={},d=a.names(),f=a.timestamp?Math.floor(a.timestamp/1E3):null;d.forEach(function(e){var d=
a.stat(e);switch(e){case "googCodecName":""!==d&&(b.codecName=d);break;case "googJitterBufferMs":b.googJitterBufferMs=Number(d);break;case "googJitterReceived":e=Number(d);-1!==e&&(b.jitter=e);break;case "bytesReceived":case "bytesSent":case "packetsReceived":case "packetsSent":case "timestamp":case "audioInputLevel":case "audioOutputLevel":b[e]=Number(d);break;case "packetsLost":d=Number(d);-1!==d&&(b[e]=d);break;default:c[e]=d}});b.timestamp=f;return e(b,c)}function d(a,b){var d=[],f=[];a.forEach(function(a){var b=
null;switch(a.type){case "inboundrtp":var c={},b={},k;for(k in a){var l=a[k];switch(k){case "mozRtt":c.rtt=l;break;case "timestamp":c[k]=Math.floor(l/1E3);break;case "jitter":c[k]=1E3*l;break;case "bytesReceived":case "packetsLost":case "packetsReceived":c[k]=l;break;default:b[k]=l}}b=e(c,b);break;case "outboundrtp":if(!1===a.isRemote){k={};b={};for(c in a)switch(l=a[c],c){case "timestamp":k[c]=Math.floor(l/1E3);case "bytesSent":case "packetsSent":k[c]=l;break;default:b[c]=l}b=e(k,b)}break;default:f.push(a)}b&&
d.push(b)});if(0===d.length||0===(d=c(d)).length)return b(null,{});var l=d.reduceRight(function(a,b){for(var c in b)a[c]=b[c];return a},{});b(null,l)}function e(a,b){var c=null;f(a)||(c=c||{},c.known=a);f(b)||(c=c||{},c.unknown=b);return c}function c(a){for(var b=[],c=0;c<a.length;c++){var e=a[c];e.known&&b.push(e.known)}return b}function f(a){if(!a)return!0;for(var b in a)return!1;return!0}function l(a,b){return function(){var c=Array.prototype.slice.call(arguments);c.push(b);return a.apply(null,
c)}}m.exports=function(b,c){var e=Error("WebRTC statistics are unsupported");b?"undefined"===typeof navigator||"function"!==typeof b.getStats?c(e):navigator.webkitGetUserMedia?b.getStats(l(a,c),c):navigator.mozGetUserMedia?b.getStats(null,l(d,c),c):c(e):c(Error("PeerConnection is null"))}},{}],15:[function(g,m,h){function a(b){if(!(this instanceof a))return new a(b);this.id=a.nextId++;a.items[this.id]=this;this.create();return this}g={create:function(){this.audio=document.createElement("audio");this.playing=
!1},buffer:function(){},play:function(a,b){if(!(this.playing||0>=b)){if(this.audio.currentTime!==a)try{if(this.audio.currentTime=a,this.audio.currentTime!==a)throw Error();}catch(c){var f=this.audio.src;this.audio.src="";this.audio.src=f}this.playing=!0;this.audio.play();var l=this;this.audio.addEventListener("ended",function k(){l.audio.removeEventListener("ended",k,!1);l.playing?(l.playing=!1,l.play(a,b-1)):l.playing=!1},!1)}},load:function(a){this.audio.src=a},stop:function(){this.playing=!1},
destroy:function(){this.audio.src="";delete this.audio}};m={create:function(){},buffer:function(a){},play:function(a,b){},load:function(a){},stop:function(){},destroy:function(){}};if("undefined"===typeof window)for(var b in m)a.prototype[b]=m[b];else a.prototype=g;a.nextId=0;a.debug=!1;a.tasks=[];a.items={};h.Sound=a},{}],16:[function(g,m,h){function a(a,b){return function(){var c=Array.prototype.slice(arguments);b.apply(a,c)}}function b(){if(!(this instanceof b))return new b;this.cache={}}b.prototype.add=
function(a,b,c){c=c||{};if(!(c instanceof Object))throw new TypeError("Bad envelope type; expected Object");b instanceof Array||(b=[b]);this.cache[a]={starttime:null,sounds:b,envelope:c}};b.prototype.play=function(a,b,c){b=b||0;c=c||1;if(a in this.cache){a=this.cache[a];for(var f=0;f<a.sounds.length;f++)a.sounds[f].play(b,c);a.starttime=(new Date).getTime()}};b.prototype.stop=function(a){if(a in this.cache){var b=this.cache[a];a=b.envelope.release||0;var c=function(){for(var a=0;a<b.sounds.length;a++)b.sounds[a].stop()},
f=(new Date).getTime(),f=Math.max(0,a-(f-b.starttime));0==a?c():setTimeout(c,f)}};b.prototype.envelope=function(a,b){if(a in this.cache){var c=this.cache[a],f;for(f in b)c.envelope[f]=b[f]}};b.prototype.playseq=function(){var b=null,e=[],c=function(){var f=e.shift();if(f){var l=f[0],g=f[1]||0,f=f[2]||0;l in this.cache&&this.play(l);b=setTimeout(a(this,c),g+f)}else b=null};return function(f){for(var l=0;l<f.length;l++)e.push(f[l]);null==b&&(b=setTimeout(a(this,c),0))}}();h.SoundCache=b},{}],17:[function(g,
m,h){function a(b,c){if(!(this instanceof a))return new a(b,c);var d=c;Object.defineProperties(this,{_currentState:{get:function(){return d},set:function(a){d=a}},currentState:{enumerable:!0,get:function(){return d}},states:{enumerable:!0,value:b},transitions:{enumerable:!0,value:[]}});Object.freeze(this)}function b(a,b){Object.defineProperties(this,{from:{enumerable:!0,value:a},to:{enumerable:!0,value:b}})}function d(a,c){if(!(this instanceof d))return new d(a,c);Error.call(this);b.call(this,a,c);
Object.defineProperties(this,{message:{enumerable:!0,value:"Invalid transition from "+("string"===typeof a?'"'+a+'"':"null")+' to "'+c+'"'}});Object.freeze(this)}g=g("util").inherits;a.prototype.transition=function(a){var c=this.currentState,f=this.states[c],c=f&&-1!==f.indexOf(a)?new b(c,a):new d(c,a);this.transitions.push(c);this._currentState=a;if(c instanceof d)throw c;return this};g(d,Error);m.exports=a},{util:28}],18:[function(g,m,h){(function(a){function b(a){if(!(this instanceof b))return new b(a);
this.message=a}function d(a){return function(){var b=Array.prototype.slice.call(arguments,0);a.memo=a.memo||{};return a.memo[b]?a.memo[b]:a.memo[b]=a.apply(null,b)}}function e(a){a=a.split(".");if(3!=a.length)throw new b("Wrong number of segments");return u(a[1])}function c(a){if(""==a)return{};if(-1==a.indexOf("&")&&-1==a.indexOf("="))return a;a=a.split("&");for(var b={},q=0;q<a.length;q++){var e=a[q].split("=");b[decodeURIComponent(e[0])]=c(decodeURIComponent(e[1]))}return b}function f(b){try{return btoa(b)}catch(n){return(new a(b)).toString("base64")}}
function l(b){try{return atob(b)}catch(n){try{return(new a(b,"base64")).toString("ascii")}catch(c){return base64.decode(b)}}}function v(a){var b=[],c;for(c in a){var e="object"==typeof a[c]?v(a[c]):a[c];b.push(encodeURIComponent(c)+"="+encodeURIComponent(e))}return b.join("&")}function k(a){return k.WEBRTC}function x(){var a=x.UNKNOWN,b=999;if("undefined"!==typeof navigator)if(navigator.mozGetUserMedia){a=x.FIREFOX;try{b=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)}catch(c){}}else if(navigator.webkitGetUserMedia){var a=
x.CHROME,e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(null!==e)try{b=parseInt(e[2],10)}catch(d){}}return[a,b]}function p(a,b){return a===b?!0:typeof a!==typeof b?!1:a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():"object"!==typeof a&&"object"!==typeof b?a==b:w(a,b)}function w(a,b){if(void 0===a||null===a||void 0===b||null===b||a.prototype!==b.prototype)return!1;try{var c=r(a),e=r(b)}catch(d){return!1}if(c.length!==e.length)return!1;c.sort();e.sort();for(e=c.length-1;0<=
e;e--){var f=c[e];if(!p(a[f],b[f]))return!1}return!0}var t=g("events").EventEmitter;b.prototype.toString=function(){return"Twilio.Exception: "+this.message};var u=d(function(a){var b=a.length%4;0<b&&(a+=Array(4-b+1).join("="));a=a.replace(/-/g,"+").replace(/_/g,"/");a=l(a);return JSON.parse(a)}),m=d(function(a){a=e(a);for(var n=0===a.scope.length?[]:a.scope.split(" "),q={},d=0;d<n.length;d++){var f;f=n[d].match(/^scope:(\w+):(\w+)\??(.*)$/);if(!f||4!=f.length)throw new b("Bad scope URI");f={service:f[1],
privilege:f[2],params:c(f[3])};q[f.service+":"+f.privilege]=f}a.scope=q;return a}),C=function(){function a(){this.set={}}a.prototype.clear=function(){this.set={}};a.prototype.put=function(b){return this.set[b]=a.DUMMY};a.prototype.del=function(a){return delete this.set[a]};a.prototype.map=function(a,b){var c=[],e;for(e in this.set)c.push(a.call(b,e));return c};a.DUMMY={};return a}(),z="";k.WEBRTC="WebRTC";k.ORTC="ORTC";x.CHROME="chrome";x.FIREFOX="firefox";x.UNKNOWN="unknown";var r="function"===typeof Object.keys?
Object.keys:function(a){var b=[],c;for(c in a)b.push(c);return b};h.getSDKVersion=function(){return"1.3"};h.encodescope=function(a,b,c){a=["scope",a,b].join(":");b=!0;for(var e in c){b=!1;break}return b?a:a+"?"+v(c)};h.dummyToken=function(a){var b={iss:"AC1111111111111111111111111111111",exp:14E8},c;for(c in b)a[c]=a[c]||b[c];a=f(JSON.stringify(a));a=a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");return["*",a,"*"].join(".")};h.Exception=b;h.decode=e;h.btoa=f;h.atob=l;h.objectize=m;h.urlencode=
function(a,b){var c=[];b=b||!1;for(var e in a)if(b&&a[e]instanceof Array)for(var d in a[e]){var f=a[e][d];c.push(encodeURIComponent(e)+"="+encodeURIComponent(f))}else f=a[e],c.push(encodeURIComponent(e)+"="+encodeURIComponent(f));return c.join("&")};h.Set=C;h.bind=function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return a.apply(b,c.concat(e))}};h.getSystemInfo=function(){g("./rtc");var a="undefined"!=typeof navigator?navigator:
{};return{p:"browser",v:"1.3",h:"419f170",browser:{userAgent:a.userAgent||"unknown",platform:a.platform||"unknown"},plugin:"rtc"}};h.splitObjects=function(a,b){var c;c="string"!=typeof a?"":a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");return 0==c.length?[]:c.split("\n")};h.generateConnectionUUID=function(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};h.getTwilioRoot=function(){return z};h.setTwilioRoot=function(a){z=
a};h.getMediaEngine=k;h.mixinGetMediaEngine=function(a){a.getMediaEngine=function(){return k(this)};a.getMediaEngine.ORTC=k.ORTC;a.getMediaEngine.WEBRTC=k.WEBRTC;return a};h.monitorEventEmitter=function(a,b){function c(e){var d=t.listenerCount(b,e);e="The number of "+e+" listeners on "+a+" exceeds the recommended number of 10. While twilio.js will continue to function normally, this may be indicative of an application error. Note that "+e+" listeners exist for the lifetime of the "+a+".";10<=d&&("undefined"!==
typeof console&&(console.warn?console.warn(e):console.log&&console.log(e)),b.removeListener("newListener",c))}b.setMaxListeners(0);b.on("newListener",c)};h.detectBrowser=x;h.deepEqual=p}).call(this,g("buffer").Buffer)},{"./rtc":11,buffer:20,events:24}],19:[function(g,m,h){function a(b){var e=this instanceof a?this:new a(b);e.sock=null;var l=function(){};e.onopen=l;e.onclose=l;e.onmessage=l;e.onerror=l;l={logPrefix:"[WSTransport]",chunderw:"chunderw-vpc-gll.twilio.com",reconnect:!0,debug:!1,secureSignaling:!0};
b=b||{};for(var g in l)g in b||(b[g]=l[g]);e.options=b;d.mixinLog(e,e.options.logPrefix);e.log.enabled=e.options.debug;e.defaultReconnect=e.options.reconnect;e.uri=(e.options.secureSignaling?"wss://":"ws://")+e.options.host+"/signal";return e}var b=g("./heartbeat").Heartbeat,d=g("./log"),e=g("ws");a.prototype.msgQueue=[];a.prototype.open=function(a){this.log("Opening socket");this.sock&&2>this.sock.readyState?this.log("Socket already open."):(this.options.reconnect=this.defaultReconnect,this.heartbeat&&
(this.heartbeat.onsleep=function(){}),this.heartbeat=new b({interval:15}),this.sock=this._connect(a))};a.prototype.send=function(a){if(this.sock)if(0==this.sock.readyState)this.msgQueue.push(a);else try{this.sock.send(a)}catch(b){this.log("Error while sending. Closing socket: "+b.message),this.sock.close()}};a.prototype.close=function(){this.log("Closing socket");this.options.reconnect=!1;this.sock&&(this.sock.close(),this.sock=null);this.heartbeat.onsleep=function(){}};a.prototype._cleanupSocket=
function(a){if(a){this.log("Cleaning up socket");var b=function(){};a.onopen=function(){a.close()};a.onmessage=b;a.onerror=b;a.onclose=b;2>a.readyState&&a.close()}};a.prototype._connect=function(a){var b=++a||1;this.log("attempting to connect");var d=null;try{d=new e(this.uri)}catch(g){this.onerror({code:31E3,message:g.message||"Could not connect to "+this.uri});this.close();return}var k=this,h=this.sock,p=null,w=setTimeout(function(){k.log("connection attempt timed out");d.onclose=function(){};d.close();
k.onclose();k._tryReconnect(b)},5E3);d.onopen=function(){clearTimeout(w);k._cleanupSocket(h);p=(new Date).getTime();k.log("Socket opened");k.heartbeat.onsleep=function(){k.log("Heartbeat timed out. closing socket");k.sock.onclose=function(){};k.sock.close();k.onclose();k._tryReconnect(b)};k.heartbeat.beat();k.onopen();for(var a=0;a<k.msgQueue.length;a++)k.sock.send(k.msgQueue[a]);k.msgQueue=[]};d.onclose=function(){clearTimeout(w);k._cleanupSocket(h);k.heartbeat.onsleep=function(){};p&&10<((new Date).getTime()-
p)/1E3&&(b=1);k.log("Socket closed");k.onclose();k._tryReconnect(b)};d.onerror=function(a){k.log("Socket received error: "+a.message);k.onerror({code:31E3,message:a.message||"WSTransport socket error"})};d.onmessage=function(a){k.heartbeat.beat();if("\n"==a.data)k.send("\n");else k.onmessage(a)};return d};a.prototype._tryReconnect=function(a){a=a||0;if(this.options.reconnect){this.log("Attempting to reconnect.");var b=this,e=0;5>a?(e=50*Math.pow(2,a),e=30+Math.round(Math.random()*e)):e=3E3;setTimeout(function(){b.open(a)},
e)}};h.WSTransport=a},{"./heartbeat":5,"./log":6,ws:42}],20:[function(g,m,h){function a(b,c,e){if(!(this instanceof a))return new a(b,c,e);var d=typeof b,f;if("number"===d)f=0<b?b>>>0:0;else if("string"===d){if("base64"===c)for(b=(b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")).replace(B,"");0!==b.length%4;)b+="=";f=a.byteLength(b,c)}else if("object"===d&&null!==b)"Buffer"===b.type&&C(b.data)&&(b=b.data),f=0<+b.length?Math.floor(+b.length):0;else throw new TypeError("must start with number, buffer, array or string");
if(this.length>z)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+z.toString(16)+" bytes");var k;a.TYPED_ARRAY_SUPPORT?k=a._augment(new Uint8Array(f)):(k=this,k.length=f,k._isBuffer=!0);if(a.TYPED_ARRAY_SUPPORT&&"number"===typeof b.byteLength)k._set(b);else{var l=b;if(C(l)||a.isBuffer(l)||l&&"object"===typeof l&&"number"===typeof l.length)if(a.isBuffer(b))for(c=0;c<f;c++)k[c]=b.readUInt8(c);else for(c=0;c<f;c++)k[c]=(b[c]%256+256)%256;else if("string"===d)k.write(b,0,
c);else if("number"===d&&!a.TYPED_ARRAY_SUPPORT&&!e)for(c=0;c<f;c++)k[c]=0}return k}function b(a,b,c){var e="";for(c=Math.min(a.length,c);b<c;b++)e+=String.fromCharCode(a[b]);return e}function d(a,b,c){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length");}function e(b,c,e,d,f,k){if(!a.isBuffer(b))throw new TypeError("buffer must be a Buffer instance");if(c>f||c<k)throw new TypeError("value is out of bounds");if(e+d>b.length)throw new TypeError("index out of range");
}function c(a,b,c,e){0>b&&(b=65535+b+1);for(var d=0,f=Math.min(a.length-c,2);d<f;d++)a[c+d]=(b&255<<8*(e?d:1-d))>>>8*(e?d:1-d)}function f(a,b,c,e){0>b&&(b=4294967295+b+1);for(var d=0,f=Math.min(a.length-c,4);d<f;d++)a[c+d]=b>>>8*(e?d:3-d)&255}function l(a,b,c,e,d,f){if(b>d||b<f)throw new TypeError("value is out of bounds");if(c+e>a.length)throw new TypeError("index out of range");}function v(a,b,c,e,d){d||l(a,b,c,4,3.4028234663852886E38,-3.4028234663852886E38);A.write(a,b,c,e,23,4);return c+4}function k(a,
b,c,e,d){d||l(a,b,c,8,1.7976931348623157E308,-1.7976931348623157E308);A.write(a,b,c,e,52,8);return c+8}function x(a){for(var b=[],c=0;c<a.length;c++){var e=a.charCodeAt(c);if(127>=e)b.push(e);else{var d=c;55296<=e&&57343>=e&&c++;e=encodeURIComponent(a.slice(d,c+1)).substr(1).split("%");for(d=0;d<e.length;d++)b.push(parseInt(e[d],16))}}return b}function p(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b}function w(a,b,c,e,d){d&&(e-=e%d);for(d=0;d<e&&!(d+c>=b.length||d>=a.length);d++)b[d+
c]=a[d];return d}function t(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var u=g("base64-js"),A=g("ieee754"),C=g("is-array");h.Buffer=a;h.SlowBuffer=a;h.INSPECT_MAX_BYTES=50;a.poolSize=8192;var z=1073741823;a.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);b.foo=function(){return 42};return 42===b.foo()&&"function"===typeof b.subarray&&0===(new Uint8Array(1)).subarray(1,1).byteLength}catch(c){return!1}}();a.isBuffer=function(a){return!(null==
a||!a._isBuffer)};a.compare=function(b,c){if(!a.isBuffer(b)||!a.isBuffer(c))throw new TypeError("Arguments must be Buffers");for(var e=b.length,d=c.length,f=0,k=Math.min(e,d);f<k&&b[f]===c[f];f++);f!==k&&(e=b[f],d=c[f]);return e<d?-1:d<e?1:0};a.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};a.concat=function(b,c){if(!C(b))throw new TypeError("Usage: Buffer.concat(list[, length])");
if(0===b.length)return new a(0);if(1===b.length)return b[0];var e;if(void 0===c)for(e=c=0;e<b.length;e++)c+=b[e].length;var d=new a(c),f=0;for(e=0;e<b.length;e++){var k=b[e];k.copy(d,f);f+=k.length}return d};a.byteLength=function(a,b){var c;a+="";switch(b||"utf8"){case "ascii":case "binary":case "raw":c=a.length;break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=2*a.length;break;case "hex":c=a.length>>>1;break;case "utf8":case "utf-8":c=x(a).length;break;case "base64":c=u.toByteArray(a).length;
break;default:c=a.length}return c};a.prototype.length=void 0;a.prototype.parent=void 0;a.prototype.toString=function(a,c,e){var d=!1;c>>>=0;e=void 0===e||Infinity===e?this.length:e>>>0;a||(a="utf8");0>c&&(c=0);e>this.length&&(e=this.length);if(e<=c)return"";for(;;)switch(a){case "hex":a=c;c=this.length;if(!a||0>a)a=0;if(!e||0>e||e>c)e=c;for(c="";a<e;a++)d=this[a],d=16>d?"0"+d.toString(16):d.toString(16),c+=d;return c;case "utf8":case "utf-8":a=c;d=c="";for(e=Math.min(this.length,e);a<e;a++)127>=this[a]?
(c+=t(d)+String.fromCharCode(this[a]),d=""):d+="%"+this[a].toString(16);return c+t(d);case "ascii":return b(this,c,e);case "binary":return b(this,c,e);case "base64":return a=c,e=0===a&&e===this.length?u.fromByteArray(this):u.fromByteArray(this.slice(a,e)),e;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":e=this.slice(c,e);a="";for(c=0;c<e.length;c+=2)a+=String.fromCharCode(e[c]+256*e[c+1]);return a;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}};a.prototype.equals=
function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return 0===a.compare(this,b)};a.prototype.inspect=function(){var a="",b=h.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... "));return"<Buffer "+a+">"};a.prototype.compare=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return a.compare(this,b)};a.prototype.get=function(a){console.log(".get() is deprecated. Access using array indexes instead.");
return this.readUInt8(a)};a.prototype.set=function(a,b){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(a,b)};a.prototype.write=function(a,b,c,e){if(isFinite(b))isFinite(c)||(e=c,c=void 0);else{var d=e;e=b;b=c;c=d}b=Number(b)||0;d=this.length-b;c?(c=Number(c),c>d&&(c=d)):c=d;e=String(e||"utf8").toLowerCase();switch(e){case "hex":b=Number(b)||0;e=this.length-b;c?(c=Number(c),c>e&&(c=e)):c=e;e=a.length;if(0!==e%2)throw Error("Invalid hex string");c>e/
2&&(c=e/2);for(e=0;e<c;e++){d=parseInt(a.substr(2*e,2),16);if(isNaN(d))throw Error("Invalid hex string");this[b+e]=d}a=e;break;case "utf8":case "utf-8":a=w(x(a),this,b,c);break;case "ascii":a=w(p(a),this,b,c);break;case "binary":a=w(p(a),this,b,c);break;case "base64":a=w(u.toByteArray(a),this,b,c);break;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":for(var f,d=[],k=0;k<a.length;k++)f=a.charCodeAt(k),e=f>>8,f%=256,d.push(f),d.push(e);a=w(d,this,b,c,2);break;default:throw new TypeError("Unknown encoding: "+
e);}return a};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};a.prototype.slice=function(b,c){var e=this.length;b=~~b;c=void 0===c?e:~~c;0>b?(b+=e,0>b&&(b=0)):b>e&&(b=e);0>c?(c+=e,0>c&&(c=0)):c>e&&(c=e);c<b&&(c=b);if(a.TYPED_ARRAY_SUPPORT)return a._augment(this.subarray(b,c));for(var e=c-b,d=new a(e,void 0,!0),f=0;f<e;f++)d[f]=this[f+b];return d};a.prototype.readUInt8=function(a,b){b||d(a,1,this.length);return this[a]};a.prototype.readUInt16LE=
function(a,b){b||d(a,2,this.length);return this[a]|this[a+1]<<8};a.prototype.readUInt16BE=function(a,b){b||d(a,2,this.length);return this[a]<<8|this[a+1]};a.prototype.readUInt32LE=function(a,b){b||d(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};a.prototype.readUInt32BE=function(a,b){b||d(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};a.prototype.readInt8=function(a,b){b||d(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};
a.prototype.readInt16LE=function(a,b){b||d(a,2,this.length);var c=this[a]|this[a+1]<<8;return c&32768?c|4294901760:c};a.prototype.readInt16BE=function(a,b){b||d(a,2,this.length);var c=this[a+1]|this[a]<<8;return c&32768?c|4294901760:c};a.prototype.readInt32LE=function(a,b){b||d(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};a.prototype.readInt32BE=function(a,b){b||d(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};a.prototype.readFloatLE=function(a,
b){b||d(a,4,this.length);return A.read(this,a,!0,23,4)};a.prototype.readFloatBE=function(a,b){b||d(a,4,this.length);return A.read(this,a,!1,23,4)};a.prototype.readDoubleLE=function(a,b){b||d(a,8,this.length);return A.read(this,a,!0,52,8)};a.prototype.readDoubleBE=function(a,b){b||d(a,8,this.length);return A.read(this,a,!1,52,8)};a.prototype.writeUInt8=function(b,c,d){b=+b;c>>>=0;d||e(this,b,c,1,255,0);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));this[c]=b;return c+1};a.prototype.writeUInt16LE=function(b,
d,f){b=+b;d>>>=0;f||e(this,b,d,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[d]=b,this[d+1]=b>>>8):c(this,b,d,!0);return d+2};a.prototype.writeUInt16BE=function(b,d,f){b=+b;d>>>=0;f||e(this,b,d,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[d]=b>>>8,this[d+1]=b):c(this,b,d,!1);return d+2};a.prototype.writeUInt32LE=function(b,c,d){b=+b;c>>>=0;d||e(this,b,c,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=b):f(this,b,c,!0);return c+4};a.prototype.writeUInt32BE=function(b,
c,d){b=+b;c>>>=0;d||e(this,b,c,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=b):f(this,b,c,!1);return c+4};a.prototype.writeInt8=function(b,c,d){b=+b;c>>>=0;d||e(this,b,c,1,127,-128);a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b));0>b&&(b=255+b+1);this[c]=b;return c+1};a.prototype.writeInt16LE=function(b,d,f){b=+b;d>>>=0;f||e(this,b,d,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[d]=b,this[d+1]=b>>>8):c(this,b,d,!0);return d+2};a.prototype.writeInt16BE=function(b,
d,f){b=+b;d>>>=0;f||e(this,b,d,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[d]=b>>>8,this[d+1]=b):c(this,b,d,!1);return d+2};a.prototype.writeInt32LE=function(b,c,d){b=+b;c>>>=0;d||e(this,b,c,4,2147483647,-2147483648);a.TYPED_ARRAY_SUPPORT?(this[c]=b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):f(this,b,c,!0);return c+4};a.prototype.writeInt32BE=function(b,c,d){b=+b;c>>>=0;d||e(this,b,c,4,2147483647,-2147483648);0>b&&(b=4294967295+b+1);a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+
2]=b>>>8,this[c+3]=b):f(this,b,c,!1);return c+4};a.prototype.writeFloatLE=function(a,b,c){return v(this,a,b,!0,c)};a.prototype.writeFloatBE=function(a,b,c){return v(this,a,b,!1,c)};a.prototype.writeDoubleLE=function(a,b,c){return k(this,a,b,!0,c)};a.prototype.writeDoubleBE=function(a,b,c){return k(this,a,b,!1,c)};a.prototype.copy=function(b,c,e,d){e||(e=0);d||0===d||(d=this.length);c||(c=0);if(d!==e&&0!==b.length&&0!==this.length){if(d<e)throw new TypeError("sourceEnd < sourceStart");if(0>c||c>=b.length)throw new TypeError("targetStart out of bounds");
if(0>e||e>=this.length)throw new TypeError("sourceStart out of bounds");if(0>d||d>this.length)throw new TypeError("sourceEnd out of bounds");d>this.length&&(d=this.length);b.length-c<d-e&&(d=b.length-c+e);d-=e;if(1E3>d||!a.TYPED_ARRAY_SUPPORT)for(var f=0;f<d;f++)b[f+c]=this[f+e];else b._set(this.subarray(e,e+d),c)}};a.prototype.fill=function(a,b,c){a||(a=0);b||(b=0);c||(c=this.length);if(c<b)throw new TypeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new TypeError("start out of bounds");
if(0>c||c>this.length)throw new TypeError("end out of bounds");if("number"===typeof a)for(;b<c;b++)this[b]=a;else{a=x(a.toString());for(var e=a.length;b<c;b++)this[b]=a[b%e]}return this}};a.prototype.toArrayBuffer=function(){if("undefined"!==typeof Uint8Array){if(a.TYPED_ARRAY_SUPPORT)return(new a(this)).buffer;for(var b=new Uint8Array(this.length),c=0,e=b.length;c<e;c+=1)b[c]=this[c];return b.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser");};var r=a.prototype;a._augment=
function(b){b.constructor=a;b._isBuffer=!0;b._get=b.get;b._set=b.set;b.get=r.get;b.set=r.set;b.write=r.write;b.toString=r.toString;b.toLocaleString=r.toString;b.toJSON=r.toJSON;b.equals=r.equals;b.compare=r.compare;b.copy=r.copy;b.slice=r.slice;b.readUInt8=r.readUInt8;b.readUInt16LE=r.readUInt16LE;b.readUInt16BE=r.readUInt16BE;b.readUInt32LE=r.readUInt32LE;b.readUInt32BE=r.readUInt32BE;b.readInt8=r.readInt8;b.readInt16LE=r.readInt16LE;b.readInt16BE=r.readInt16BE;b.readInt32LE=r.readInt32LE;b.readInt32BE=
r.readInt32BE;b.readFloatLE=r.readFloatLE;b.readFloatBE=r.readFloatBE;b.readDoubleLE=r.readDoubleLE;b.readDoubleBE=r.readDoubleBE;b.writeUInt8=r.writeUInt8;b.writeUInt16LE=r.writeUInt16LE;b.writeUInt16BE=r.writeUInt16BE;b.writeUInt32LE=r.writeUInt32LE;b.writeUInt32BE=r.writeUInt32BE;b.writeInt8=r.writeInt8;b.writeInt16LE=r.writeInt16LE;b.writeInt16BE=r.writeInt16BE;b.writeInt32LE=r.writeInt32LE;b.writeInt32BE=r.writeInt32BE;b.writeFloatLE=r.writeFloatLE;b.writeFloatBE=r.writeFloatBE;b.writeDoubleLE=
r.writeDoubleLE;b.writeDoubleBE=r.writeDoubleBE;b.fill=r.fill;b.inspect=r.inspect;b.toArrayBuffer=r.toArrayBuffer;return b};var B=/[^+\/0-9A-z]/g},{"base64-js":21,ieee754:22,"is-array":23}],21:[function(g,m,h){(function(a){function b(a){a=a.charCodeAt(0);if(43===a)return 62;if(47===a)return 63;if(48>a)return-1;if(58>a)return a-48+52;if(91>a)return a-65;if(123>a)return a-97+26}var d="undefined"!==typeof Uint8Array?Uint8Array:Array;a.toByteArray=function(a){function c(a){h[p++]=a}var f,l,g,k,h;if(0<
a.length%4)throw Error("Invalid string. Length must be a multiple of 4");f=a.length;k="="===a.charAt(f-2)?2:"="===a.charAt(f-1)?1:0;h=new d(3*a.length/4-k);l=0<k?a.length-4:a.length;var p=0;for(f=0;f<l;f+=4)g=b(a.charAt(f))<<18|b(a.charAt(f+1))<<12|b(a.charAt(f+2))<<6|b(a.charAt(f+3)),c((g&16711680)>>16),c((g&65280)>>8),c(g&255);2===k?(g=b(a.charAt(f))<<2|b(a.charAt(f+1))>>4,c(g&255)):1===k&&(g=b(a.charAt(f))<<10|b(a.charAt(f+1))<<4|b(a.charAt(f+2))>>2,c(g>>8&255),c(g&255));return h};a.fromByteArray=
function(a){var b,d=a.length%3,l="",g,k;b=0;for(k=a.length-d;b<k;b+=3)g=(a[b]<<16)+(a[b+1]<<8)+a[b+2],g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g&63),l+=g;switch(d){case 1:g=a[a.length-1];l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>
2);l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g<<4&63);l+="==";break;case 2:g=(a[a.length-2]<<8)+a[a.length-1],l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>10),l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>4&63),l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g<<2&63),l+="="}return l}})("undefined"===typeof h?this.base64js={}:h)},{}],22:[function(g,m,h){h.read=function(a,
b,d,e,c){var f;f=8*c-e-1;var g=(1<<f)-1,h=g>>1,k=-7;c=d?c-1:0;var x=d?-1:1,p=a[b+c];c+=x;d=p&(1<<-k)-1;p>>=-k;for(k+=f;0<k;d=256*d+a[b+c],c+=x,k-=8);f=d&(1<<-k)-1;d>>=-k;for(k+=e;0<k;f=256*f+a[b+c],c+=x,k-=8);if(0===d)d=1-h;else{if(d===g)return f?NaN:Infinity*(p?-1:1);f+=Math.pow(2,e);d-=h}return(p?-1:1)*f*Math.pow(2,d-e)};h.write=function(a,b,d,e,c,f){var g,h=8*f-c-1,k=(1<<h)-1,x=k>>1,p=23===c?Math.pow(2,-24)-Math.pow(2,-77):0;f=e?0:f-1;var w=e?1:-1,t=0>b||0===b&&0>1/b?1:0;b=Math.abs(b);isNaN(b)||
Infinity===b?(b=isNaN(b)?1:0,e=k):(e=Math.floor(Math.log(b)/Math.LN2),1>b*(g=Math.pow(2,-e))&&(e--,g*=2),b=1<=e+x?b+p/g:b+p*Math.pow(2,1-x),2<=b*g&&(e++,g/=2),e+x>=k?(b=0,e=k):1<=e+x?(b=(b*g-1)*Math.pow(2,c),e+=x):(b=b*Math.pow(2,x-1)*Math.pow(2,c),e=0));for(;8<=c;a[d+f]=b&255,f+=w,b/=256,c-=8);e=e<<c|b;for(h+=c;0<h;a[d+f]=e&255,f+=w,e/=256,h-=8);a[d+f-w]|=128*t}},{}],23:[function(g,m,h){var a=Object.prototype.toString;m.exports=Array.isArray||function(b){return!!b&&"[object Array]"==a.call(b)}},
{}],24:[function(g,m,h){function a(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function b(a){return"function"===typeof a}function d(a){return"object"===typeof a&&null!==a}m.exports=a;a.EventEmitter=a;a.prototype._events=void 0;a.prototype._maxListeners=void 0;a.defaultMaxListeners=10;a.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||isNaN(a))throw TypeError("n must be a positive number");this._maxListeners=a;return this};a.prototype.emit=function(a){var c,
f,g,h;this._events||(this._events={});if("error"===a&&(!this._events.error||d(this._events.error)&&!this._events.error.length)){c=arguments[1];if(c instanceof Error)throw c;throw TypeError('Uncaught, unspecified "error" event.');}f=this._events[a];if(void 0===f)return!1;if(b(f))switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:c=arguments.length;g=Array(c-1);for(h=1;h<c;h++)g[h-1]=arguments[h];f.apply(this,
g)}else if(d(f)){c=arguments.length;g=Array(c-1);for(h=1;h<c;h++)g[h-1]=arguments[h];f=f.slice();c=f.length;for(h=0;h<c;h++)f[h].apply(this,g)}return!0};a.prototype.addListener=function(e,c){var f;if(!b(c))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",e,b(c.listener)?c.listener:c);this._events[e]?d(this._events[e])?this._events[e].push(c):this._events[e]=[this._events[e],c]:this._events[e]=c;d(this._events[e])&&!this._events[e].warned&&
(f=void 0!==this._maxListeners?this._maxListeners:a.defaultMaxListeners)&&0<f&&this._events[e].length>f&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"===typeof console.trace&&console.trace());return this};a.prototype.on=a.prototype.addListener;a.prototype.once=function(a,c){function d(){this.removeListener(a,d);g||(g=!0,c.apply(this,arguments))}
if(!b(c))throw TypeError("listener must be a function");var g=!1;d.listener=c;this.on(a,d);return this};a.prototype.removeListener=function(a,c){var f,g,h;if(!b(c))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;f=this._events[a];h=f.length;g=-1;if(f===c||b(f.listener)&&f.listener===c)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,c);else if(d(f)){for(;0<h--;)if(f[h]===c||f[h].listener&&f[h].listener===c){g=h;break}if(0>
g)return this;1===f.length?(f.length=0,delete this._events[a]):f.splice(g,1);this._events.removeListener&&this.emit("removeListener",a,c)}return this};a.prototype.removeAllListeners=function(a){var c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(c in this._events)"removeListener"!==c&&this.removeAllListeners(c);this.removeAllListeners("removeListener");this._events=
{};return this}c=this._events[a];if(b(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);delete this._events[a];return this};a.prototype.listeners=function(a){return this._events&&this._events[a]?b(this._events[a])?[this._events[a]]:this._events[a].slice():[]};a.listenerCount=function(a,c){return a._events&&a._events[c]?b(a._events[c])?1:a._events[c].length:0}},{}],25:[function(g,m,h){m.exports="function"===typeof Object.create?function(a,b){a.super_=b;a.prototype=
Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a}},{}],26:[function(g,m,h){function a(){}g=m.exports={};g.nextTick=function(){if("undefined"!==typeof window&&window.setImmediate)return function(a){return window.setImmediate(a)};if("undefined"!==typeof window&&window.postMessage&&window.addEventListener){var a=[];window.addEventListener("message",
function(d){var e=d.source;e!==window&&null!==e||"process-tick"!==d.data||(d.stopPropagation(),0<a.length&&a.shift()())},!0);return function(d){a.push(d);window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}();g.title="browser";g.browser=!0;g.env={};g.argv=[];g.on=a;g.addListener=a;g.once=a;g.off=a;g.removeListener=a;g.removeAllListeners=a;g.emit=a;g.binding=function(a){throw Error("process.binding is not supported");};g.cwd=function(){return"/"};g.chdir=function(a){throw Error("process.chdir is not supported");
}},{}],27:[function(g,m,h){m.exports=function(a){return a&&"object"===typeof a&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},{}],28:[function(g,m,h){(function(a,b){function d(a,b){var d={seen:[],stylize:c};3<=arguments.length&&(d.depth=arguments[2]);4<=arguments.length&&(d.colors=arguments[3]);u(b)?d.showHidden=b:b&&h._extend(d,b);z(d.showHidden)&&(d.showHidden=!1);z(d.depth)&&(d.depth=2);z(d.colors)&&(d.colors=!1);z(d.customInspect)&&(d.customInspect=
!0);d.colors&&(d.stylize=e);return l(d,a,d.depth)}function e(a,b){var c=d.styles[b];return c?"\u001b["+d.colors[c][0]+"m"+a+"\u001b["+d.colors[c][1]+"m":a}function c(a,b){return a}function f(a){var b={};a.forEach(function(a,c){b[a]=!0});return b}function l(a,b,c){if(a.customInspect&&b&&y(b.inspect)&&b.inspect!==h.inspect&&(!b.constructor||b.constructor.prototype!==b)){var d=b.inspect(c,a);C(d)||(d=l(a,d,c));return d}if(d=m(a,b))return d;var e=Object.keys(b),g=f(e);a.showHidden&&(e=Object.getOwnPropertyNames(b));
if(q(b)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return k(b);if(0===e.length){if(y(b))return a.stylize("[Function"+(b.name?": "+b.name:"")+"]","special");if(r(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(n(b))return a.stylize(Date.prototype.toString.call(b),"date");if(q(b))return k(b)}var d="",u=!1,A=["{","}"];t(b)&&(u=!0,A=["[","]"]);y(b)&&(d=" [Function"+(b.name?": "+b.name:"")+"]");r(b)&&(d=" "+RegExp.prototype.toString.call(b));n(b)&&(d=" "+Date.prototype.toUTCString.call(b));
q(b)&&(d=" "+k(b));if(0===e.length&&(!u||0==b.length))return A[0]+d+A[1];if(0>c)return r(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);e=u?x(a,b,c,g,e):e.map(function(d){return p(a,b,c,g,d,u)});a.seen.pop();return w(e,d,A)}function m(a,b){if(z(b))return a.stylize("undefined","undefined");if(C(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}if(A(b))return a.stylize(""+
b,"number");if(u(b))return a.stylize(""+b,"boolean");if(null===b)return a.stylize("null","null")}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function x(a,b,c,d,e){for(var f=[],g=0,k=b.length;g<k;++g)Object.prototype.hasOwnProperty.call(b,String(g))?f.push(p(a,b,c,d,String(g),!0)):f.push("");e.forEach(function(e){e.match(/^\d+$/)||f.push(p(a,b,c,d,e,!0))});return f}function p(a,b,c,d,e,f){var g,k;b=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]};b.get?k=b.set?a.stylize("[Getter/Setter]",
"special"):a.stylize("[Getter]","special"):b.set&&(k=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(d,e)||(g="["+e+"]");k||(0>a.seen.indexOf(b.value)?(k=null===c?l(a,b.value,null):l(a,b.value,c-1),-1<k.indexOf("\n")&&(k=f?k.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+k.split("\n").map(function(a){return"   "+a}).join("\n"))):k=a.stylize("[Circular]","special"));if(z(g)){if(f&&e.match(/^\d+$/))return k;g=JSON.stringify(""+e);g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?
(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+k}function w(a,b,c){var d=0;return 60<a.reduce(function(a,b){d++;0<=b.indexOf("\n")&&d++;return a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}function u(a){return"boolean"===typeof a}function A(a){return"number"===typeof a}
function C(a){return"string"===typeof a}function z(a){return void 0===a}function r(a){return B(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function B(a){return"object"===typeof a&&null!==a}function n(a){return B(a)&&"[object Date]"===Object.prototype.toString.call(a)}function q(a){return B(a)&&("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function y(a){return"function"===typeof a}function G(a){return 10>a?"0"+a.toString(10):a.toString(10)}function D(){var a=
new Date,b=[G(a.getHours()),G(a.getMinutes()),G(a.getSeconds())].join(":");return[a.getDate(),I[a.getMonth()],b].join(" ")}var F=/%[sdj%]/g;h.format=function(a){if(!C(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(d(arguments[c]));return b.join(" ")}for(var c=1,e=arguments,f=e.length,b=String(a).replace(F,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case "%s":return String(e[c++]);case "%d":return Number(e[c++]);case "%j":try{return JSON.stringify(e[c++])}catch(b){return"[Circular]"}default:return a}}),
g=e[c];c<f;g=e[++c])b=null!==g&&B(g)?b+(" "+d(g)):b+(" "+g);return b};h.deprecate=function(c,d){if(z(b.process))return function(){return h.deprecate(c,d).apply(this,arguments)};if(!0===a.noDeprecation)return c;var e=!1;return function(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d);e=!0}return c.apply(this,arguments)}};var E={},H;h.debuglog=function(b){z(H)&&(H=a.env.NODE_DEBUG||"");b=b.toUpperCase();if(!E[b])if((new RegExp("\\b"+b+"\\b","i")).test(H)){var c=
a.pid;E[b]=function(){var a=h.format.apply(h,arguments);console.error("%s %d: %s",b,c,a)}}else E[b]=function(){};return E[b]};h.inspect=d;d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};d.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};h.isArray=t;h.isBoolean=u;h.isNull=
function(a){return null===a};h.isNullOrUndefined=function(a){return null==a};h.isNumber=A;h.isString=C;h.isSymbol=function(a){return"symbol"===typeof a};h.isUndefined=z;h.isRegExp=r;h.isObject=B;h.isDate=n;h.isError=q;h.isFunction=y;h.isPrimitive=function(a){return null===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===typeof a||"undefined"===typeof a};h.isBuffer=g("./support/isBuffer");var I="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");h.log=function(){console.log("%s - %s",
D(),h.format.apply(h,arguments))};h.inherits=g("inherits");h._extend=function(a,b){if(!b||!B(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,g("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":27,_process:26,inherits:25}],29:[function(g,m,h){m.exports.RTCIceCandidate=g("./rtcicecandidate");m.exports.RTCPeerConnection=g("./rtcpeerconnection");m.exports.RTCSessionDescription=
g("./rtcsessiondescription")},{"./rtcicecandidate":32,"./rtcpeerconnection":33,"./rtcsessiondescription":35}],30:[function(g,m,h){function a(b,d,e,c,f,g,h,k,x,p){if(!(this instanceof a))return new a(b,d,e,c,f,g,h,k,x,p);var w=!1;b=b||"0.0.0.0";h="number"===typeof h?h:9;k="boolean"===typeof k?k:!0;x=x||null;p=p||null;Object.defineProperties(this,{_address:{get:function(){return b},set:function(a){b=a}},_candidates:{value:[]},_port:{get:function(){return h},set:function(a){h=a}},_rejected:{get:function(){return w},
set:function(a){w=a}},_streamId:{get:function(){return x},set:function(a){x=a}},_track:{get:function(){return p},set:function(a){p=a}},_triples:{value:new Set},candidates:{enumerable:!0,get:function(){return this._candidates.slice()}},capabilities:{enumerable:!0,value:e},defaultCandidate:{enumerable:!0,get:function(){return this._candidates.length?this._candidates[0]:null}},direction:{enumerable:!0,value:c},kind:{enumerable:!0,value:f},port:{enumerable:!0,get:function(){return h}},rtcpMux:{enumerable:!0,
value:k},streamId:{enumerable:!0,get:function(){return x}},track:{enumerable:!0,get:function(){return p}}});d&&d.forEach(this.addCandidate,this)}a.prototype.addCandidate=function(a){var d=[a.ip,a.port,a.protocol].join(" ");return this._triples.has(d)?!1:(this._triples.add(d),this._candidates.push(a),!0)};a.prototype.copy=function(b,d,e,c,f,g,h){return new a(this.address,d,e||this.capabilities,c||this.direction,this.kind,this.mid,f,this.rtcpMux,g,h)};a.prototype.copyAndReject=function(){return(new a(null,
this.candidates,this.capabilities,this.direction,this.kind,this.mid,null,this.rtcpMux)).reject()};a.prototype.reject=function(){this.setPort(0);return this};a.prototype.setAddress=function(a){this._address=a;return this};a.prototype.setPort=function(a){this._port=a;return this};m.exports=a},{}],31:[function(g,m,h){function a(b,d){if(!(this instanceof a))return new a(b,d);Event.call(this,b,d);Object.defineProperties(this,{stream:{enumerable:!0,value:d.stream}})}m.exports=a},{}],32:[function(g,m,h){function a(b){if(!(this instanceof
a))return new a(b);Object.defineProperties(this,{candidate:{enumerable:!0,value:b.candidate},sdpMLineIndex:{enumerable:!0,value:b.sdpMLineIndex}})}m.exports=a},{}],33:[function(g,m,h){function a(b){if(!(this instanceof a))return new a(b);b=d(b);var c=new RTCIceGatherer(b),e=!1;c.onlocalcandidate=this._onlocalcandidate.bind(this);var f=null,g=!1,k=0,l=new RTCIceTransport,h=null;l.onicestatechange=this._onicestatechange.bind(this);var p=new RTCDtlsTransport(l);p.ondtlsstatechange=this._ondtlsstatechange.bind(this);
var x="stable",m=null,v=null,D=null,F=null;Object.defineProperties(this,{_dtlsTransport:{value:p},_dtmfSenders:{value:new Map},_gatherOptions:{value:b},_iceCandidatesAdded:{get:function(){return k},set:function(a){k=a}},_iceGatherer:{value:c},_iceGatheringCompleted:{get:function(){return e},set:function(a){e=a}},_iceTransport:{value:l},_localCandidates:{value:new Set},_localDescription:{get:function(){return v},set:function(a){v=a}},_localStreams:{value:[]},_midCounters:{value:{audio:0,video:0}},
_remoteCandidates:{value:new Set},_remoteDescription:{get:function(){return D},set:function(a){D=a}},_remoteStreams:{value:[]},_rtpReceivers:{value:new Map},_rtpSenders:{value:new Map},_signalingState:{get:function(){return x},set:function(a){x=a;if(this.onsignalingstatechange)this.onsignalingstatechange()}},_streamIds:{value:new Map},iceConnectionState:{enumerable:!0,get:function(){return l.state}},iceGatheringState:{enumerable:!0,get:function(){return e?"gathering":"complete"}},localDescription:{enumerable:!0,
get:function(){return v}},onaddstream:{enumerable:!0,get:function(){return F},set:function(a){F=a}},onicecandidate:{enumerable:!0,get:function(){return f},set:function(a){f=a;if(!g)try{c.getLocalCandidates().forEach(c.onlocalcandidate)}catch(b){}g=!0}},oniceconnectionstatechange:{enumerable:!0,get:function(){return h},set:function(a){h=a}},onsignalingstatechange:{enumerable:!0,get:function(){return m},set:function(a){m=a}},remoteDescription:{enumerable:!0,get:function(){return D}},signalingState:{enumerable:!0,
get:function(){return x}}})}function b(a){return Error("Invalid signaling state: "+a)}function d(a){var b=(a.iceServers||[]).filter(function(a){return!a.urls.match(/^stun:/)});return{gatherPolicy:a.gatherPolicy||"all",iceServers:b}}function e(a,b){var c=[];a.forEach(function(a){b.forEach(function(b){a.name===b.name&&a.clockRate===b.clockRate&&a.numChannels===b.numChannels&&c.push(b)})});return c}var c=g("./mediasection"),f=g("./mediastreamevent"),l=g("./rtcicecandidate"),v=g("./rtcpeerconnectioniceevent"),
k=g("./rtcsessiondescription"),x=g("sdp-transform"),p=g("./sdp-utils");a.prototype._makeMid=function(a){return a+ ++this._midCounters[a]};a.prototype._ondtlsstatechange=function(a){void 0};a.prototype._onicestatechange=function(a){if(this.oniceconnectionstatechange)this.oniceconnectionstatechange(a)};a.prototype._onlocalcandidate=function(a){Object.keys(a.candidate).length||(this._iceGatheringCompleted=!0);this._localCandidates.add(a.candidate);if(this.onicecandidate){a=a.candidate;if(Object.keys(a).length){var b=
["a=candidate",a.foundation,1,a.protocol,a.priority,a.ip,a.port,a.type];a.relatedAddress&&(b=b.concat(["raddr",a.relatedAddress,"rport",a.relatedPort]));b.push("generation 0");a=new l({candidate:b.join(" "),sdpMLineIndex:0})}else a=null;this.onicecandidate(new v("icecandidate",{candidate:a}))}};a.prototype._sendRtp=function(a){var b=a.kind;this._rtpSenders.forEach(function(c){c.track.kind===b&&c.send(a.capabilities)},this);return this};a.prototype._sendAndReceiveRtp=function(a){a.forEach(function(a){"sendrecv"!==
a.direction&&"sendonly"!==a.direction||this._sendRtp(a);"sendrecv"!==a.direction&&"recvonly"!==a.direction||this._receiveRtp(a)},this);return this};a.prototype._receiveRtp=function(a){var b=new RTCRtpReceiver(this._dtlsTransport,a.capabilities.type);b.receive(a.capabilities);a=b.track;this._rtpReceivers.set(a,b);b=new MediaStream;b.addTrack(a);this._remoteStreams.push(b);if(this.onaddstream)this.onaddstream(new f("addstream",{stream:b}));return this};a.prototype._startDtlsTransport=function(a){this._dtlsTransport.start(a);
return this};a.prototype._startIceTransport=function(a){this._iceTransport.start(this._iceGatherer,a,"have-local-offer"===this.signalingState?"controlling":"controlled");return this};a.prototype.addIceCandidate=function(a,b,c){void 0;this._iceCandidatesAdded++;a?(c=a.candidate.indexOf("candidate:"),a=a.candidate.slice(c+10).replace(/ +/g," ").split(" "),c={foundation:a[0],protocol:a[2],priority:parseInt(a[3]),ip:a[4],port:parseInt(a[5]),type:a[7],relatedAddress:null,relatedPort:0,tcpType:"active"},
"host"!==c.type&&(c.relatedAddress=a[9],c.relatedPort=parseInt(a[11])),a=c):a={};c=[a.ip,a.port,a.transport].join(" ");this._remoteCandidates.has(c)||(this._remoteCandidates.add(c),this._iceTransport.addRemoteCandidate(a));b&&b()};a.prototype.addStream=function(a){this._localStreams.push(a);a.getTracks().forEach(function(b){var c=new RTCRtpSender(b,this._dtlsTransport);this._rtpSenders.set(b,c);this._streamIds.set(b,a.id)},this)};a.prototype.close=function(){this._signalingState="closed";this._rtpReceivers.forEach(function(a){a.stop()});
this._dtlsTransport.stop();this._iceTransport.stop()};a.prototype.createAnswer=function(a,c){if("have-remote-offer"!==this.signalingState)return void c(b(this.signalingState));var d=p.parseDescription(this.remoteDescription),f={audio:[],video:[]};this.getLocalStreams().forEach(function(a){f.audio=f.audio.concat(a.getAudioTracks());f.video=f.video.concat(a.getVideoTracks())});d=d.mediaSections.map(function(a){var b=a.kind,c=a.direction,d=a.capabilities,g=RTCRtpSender.getCapabilities(b),g=e(d.codecs,
g.codecs),d={codecs:g},k;if(!g.length)return a.copyAndReject();"inactive"===c||"recvonly"===c&&!f[b].length?b="inactive":"recvonly"===c?(k=f[b].shift(),b="sendonly"):b="sendrecv"===c?(k=f[b].shift())?"sendrecv":"recvonly":"recvonly";c=this._streamIds.get(k);return a.copy(null,null,d,b,null,c,k)},this);d.forEach(function(a){this._localCandidates.forEach(a.addCandidate,a)},this);var g=p.makeInitialSDPBlob();p.addMediaSectionsToSDPBlob(g,d);p.addIceParametersToSDPBlob(g,this._iceGatherer.getLocalParameters());
p.addDtlsParametersToSDPBlob(g,this._dtlsTransport.getLocalParameters());d=new k({sdp:x.write(g),type:"answer"});a(d)};a.prototype.createDTMFSender=function(a){if(!this._dtmfSenders.has(a)){var b=this._rtpSenders.get(a),b=new RTCDtmfSender(b);this._dtmfSenders.set(a,b)}return this._dtmfSenders.get(a)};a.prototype.createOffer=function(a,b,d){var e={audio:null,video:null},f={audio:0,video:0};d=d||{};["optional","mandatory"].forEach(function(a){a in d&&("OfferToReceiveAudio"in d[a]&&(e.audio=Number(d[a].OfferToReceiveAudio)),
"OfferToReceiveVideo"in d[a]&&(e.video=Number(d[a].OfferToReceiveVideo)))});var g=[],l={audio:e.audio,video:e.video};this.getLocalStreams().forEach(function(a){var b=a.getAudioTracks(),d=a.getVideoTracks();f.audio+=b.length;f.video+=d.length;b.concat(d).forEach(function(b){var d=b.kind,e=RTCRtpSender.getCapabilities(d),f,k=this._makeMid(d);null===l.audio?f="sendrecv":l[d]?(l[d]--,f="sendrecv"):f="sendonly";b=new c(null,null,e,f,d,k,null,null,a.id,b);g.push(b)},this)},this);["audio","video"].forEach(function(a){var b=
Math.max(e[a]-f[a],0);if(b)for(var d=RTCRtpSender.getCapabilities(a),k;b--;)k=this._makeMid(a),k=new c(null,null,d,"recvonly",a,k),g.push(k)},this);g.forEach(function(a){this._localCandidates.forEach(a.addCandidate,a)},this);b=p.makeInitialSDPBlob();p.addMediaSectionsToSDPBlob(b,g);p.addIceParametersToSDPBlob(b,this._iceGatherer.getLocalParameters());p.addDtlsParametersToSDPBlob(b,this._dtlsTransport.getLocalParameters());b=new k({sdp:x.write(b),type:"offer"});a(b)};a.prototype.getLocalStreams=function(){return this._localStreams.slice()};
a.prototype.getRemoteStreams=function(){return this._remoteStreams.slice()};a.prototype.setLocalDescription=function(a,c,d){switch(this.signalingState){case "stable":d="have-local-offer";break;case "have-remote-offer":d="stable";break;default:return void d(b(this.signalingState))}var e=p.parseDescription(a);"have-remote-offer"===this.signalingState&&this._sendAndReceiveRtp(e.mediaSections);this._localDescription=a;this._signalingState=d;c()};a.prototype.setRemoteDescription=function(a,c,d){switch(this.signalingState){case "stable":d=
"have-remote-offer";break;case "have-local-offer":d="stable";break;default:return void d(b(this.signalingState))}var e=p.parseDescription(a);e.mediaSections.forEach(function(a){a.candidates.forEach(this._iceTransport.addRemoteCandidate,this._iceTransport)},this);this._startIceTransport(e.iceParameters[0]);this._startDtlsTransport(e.dtlsParameters[0]);"have-local-offer"===this.signalingState&&this._sendAndReceiveRtp(e.mediaSections);this._remoteDescription=a;this._signalingState=d;c()};m.exports=a},
{"./mediasection":30,"./mediastreamevent":31,"./rtcicecandidate":32,"./rtcpeerconnectioniceevent":34,"./rtcsessiondescription":35,"./sdp-utils":36,"sdp-transform":38}],34:[function(g,m,h){function a(b,d){if(!(this instanceof a))return new a(b,d);Event.call(this,b,d);Object.defineProperties(this,{candidate:{enumerable:!0,value:d.candidate}})}m.exports=a},{}],35:[function(g,m,h){function a(b){if(!(this instanceof a))return new a(b);Object.defineProperties(this,{sdp:{enumerable:!0,value:b.sdp},type:{enumerable:!0,
value:b.type}})}m.exports=a},{}],36:[function(g,m,h){function a(a,b,c){a=a||{};a.candidates=a.candidates||[];if(!b)return a;b.forEach(function(b){if(b.foundation){var d={foundation:b.foundation,transport:b.protocol,priority:b.priority,ip:b.ip,port:b.port,type:b.type,generation:0};b.relatedAddress&&(d.raddr=b.relatedAddress,d.rport=b.relatedPort);if("number"===typeof c)d.component=c,a.candidates.push(d);else{d.component=1;a.candidates.push(d);b={};for(var e in d)b[e]=d[e];b.component=2;a.candidates.push(b)}}else a.endOfCandidates=
"end-of-candidates"});return a}function b(b,c,d){b=b||{};if(!b.media)return b;b.media.forEach(function(b){a(b,c,d)});return b}function d(a,b){a=a||{};if(!a.media)return a;a.media.forEach(function(a){a=a||{};var c=b.fingerprints;c.length&&(a.fingerprint={type:c[0].algorithm,hash:c[0].value})});return a}function e(a,b){a=a||{};if(!a.media)return a;a.media.forEach(function(a){a=a||{};a.iceUfrag=b.usernameFragment;a.icePwd=b.password});return a}function c(b,c){var d=c.streamId;d&&(b.msidSemantic=b.msidSemantic||
{semantic:"WMS",token:[]},b.msidSemantic.token.push(d));var e=c.mid;if(e){b.groups=b.groups||[];var g=!1;b.groups.forEach(function(a){"BUNDLE"===a.type&&(a.mids.push(e),g=!0)});g||b.groups.push({type:"BUNDLE",mids:[e]})}var l=[],h=[],m=[];c.capabilities.codecs.forEach(function(a){var b=a.preferredPayloadType;l.push(b);var c={payload:b,codec:a.name,rate:a.clockRate};1<a.numChannels&&(c.encoding=a.numChannels);h.push(c);switch(a.name){case "telephone-event":a.parameters&&a.parameters.events&&m.push({payload:b,
config:a.parameters.events})}});var v=[];if(d&&c.track)var d=Math.floor(4294967296*Math.random()),r=f(),B=c.track.id,v=v.concat([{id:d,attribute:"cname",value:r},{id:d,attribute:"msid",value:c.streamId+" "+B},{id:d,attribute:"mslabel",value:B},{id:d,attribute:"label",value:B}]);d=c.defaultCandidate;v={rtp:h,fmtp:m,type:c.kind,port:d?d.port:9,payloads:l.join(" "),protocol:"RTP/SAVPF",direction:c.direction,connection:{version:4,ip:d?d.ip:"0.0.0.0"},rtcp:{port:d?d.port:9,netType:"IN",ipVer:4,address:d?
d.ip:"0.0.0.0"},ssrcs:v};e&&(v.mid=e);c.rtcpMux&&(v.rtcpMux="rtcp-mux");a(v,c.candidates);b.media.push(v);return b}function f(){for(var a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/".split(""),b=16,c="";b--;)c+=a[Math.floor(Math.random()*a.length)];return c}var l=g("./mediasection"),v=g("sdp-transform");m.exports.addCandidatesToSDPBlob=function(a,c,d){a=a||{};b(a,c,d);return a};m.exports.addDtlsParametersToSDPBlob=function(a,b){a=a||{};d(a,b);return a};m.exports.addIceParametersToSDPBlob=
function(a,b){a=a||{};e(a,b);return a};m.exports.addMediaSectionsToSDPBlob=function(a,b){b.forEach(c.bind(null,a));return a};m.exports.makeInitialSDPBlob=function(a){a=a||Math.floor(4294967296*Math.random());return{version:0,origin:{username:"-",sessionId:a,sessionVersion:0,netType:"IN",ipVer:4,address:"127.0.0.1"},name:"-",timing:{start:0,stop:0},connection:{version:4,ip:"0.0.0.0"},media:[]}};m.exports.parseDescription=function(a){a=v.parse(a.sdp);var b=[],c=[],d=[],e=[],f=[a];a.media&&(f=f.concat(a.media));
f.forEach(function(a){a.iceUfrag&&a.icePwd&&a.fingerprint&&(b.push({usernameFragment:a.iceUfrag,password:a.icePwd}),c.push({fingerprints:[{algorithm:a.fingerprint.type,value:a.fingerprint.hash}]}));if(a.rtp&&"video"!==a.type){var f=a.connection?a.connection.ip:null,g=a.direction,k=a.type,h=a.mid,n=a.port||null,m="rtcp-mux"===a.rtcpMux,v,u,D;(a.ssrcs||[]).forEach(function(a){switch(a.attribute){case "cname":u=a.id;v=a.value;break;case "label":case "mslabel":u=a.id;break;case "msid":u=a.id,D=a.value.split(" ")[0]}});
var F={type:k,muxId:h,codecs:a.rtp.map(function(a){var b={name:a.codec,payloadType:parseInt(a.payload),clockRate:parseInt(a.rate),numChannels:a.encoding||1,rtcpFeedback:[],parameters:{}};switch(a.codec){case "telephone-event":b.parameters.events="0-16"}return b}),headerExtensions:[],encodings:a.rtp.map(function(a){return{ssrc:u,codecPayloadType:parseInt(a.payload),active:!0}}),rtcp:{ssrc:u,cname:v,mux:m}},E=new l(f,d,F,g,k,h,n,m,D);(a.candidates||[]).forEach(function(a){a={foundation:String(a.foundation),
protocol:a.transport,priority:a.priority,ip:a.ip,port:a.port,type:a.type,relatedAddress:a.raddr,relatedPort:a.rport};d.push(a);E.addCandidate(a)});void 0;"end-of-candidates"===a.endOfCandidates&&E.addCandidate({});e.push(E)}});return{iceParameters:b,dtlsParameters:c,mediaSections:e}}},{"./mediasection":30,"sdp-transform":38}],37:[function(g,m,h){var a=m.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),
format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol",
"payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":a.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=
a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(a){return null!=a.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",
reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},
{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: generation (\d*))?/,names:"foundation component transport priority ip port type raddr rport generation".split(" "),format:function(a){var d;
d="candidate:%s %d %s %d %s %d typ %s"+(null!=a.raddr?" raddr %s rport %d":"%v%v");null!=a.generation&&(d+=" generation %d");return d}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics",
"ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(a).forEach(function(b){a[b].forEach(function(a){a.reg||(a.reg=/(.*)/);a.format||(a.format="%s")})})},{}],38:[function(g,m,h){m=g("./parser");g=g("./writer");
h.write=g;h.parse=m.parse;h.parseFmtpConfig=m.parseFmtpConfig;h.parsePayloads=m.parsePayloads;h.parseRemoteCandidates=m.parseRemoteCandidates},{"./parser":39,"./writer":40}],39:[function(g,m,h){var a=function(a){return String(Number(a))===a?Number(a):a},b=g("./grammar"),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);h.parse=function(c){var e={},g=[],h=e;c.split(/(\r\n|\r|\n)/).filter(d).forEach(function(c){var d=c[0],e=c.slice(2);"m"===d&&(g.push({rtp:[],fmtp:[]}),h=g[g.length-1]);for(c=0;c<(b[d]||
[]).length;c+=1){var f=b[d][c];if(f.reg.test(e)){d=f;c=h;f=e;e=d.name&&d.names;d.push&&!c[d.push]?c[d.push]=[]:e&&!c[d.name]&&(c[d.name]={});var e=d.push?{}:e?c[d.name]:c,f=f.match(d.reg),m=e,u=d.names,A=d.name;if(A&&!u)m[A]=a(f[1]);else for(A=0;A<u.length;A+=1)null!=f[A+1]&&(m[u[A]]=a(f[A+1]));d.push&&c[d.push].push(e);break}}});e.media=g;return e};var e=function(b,d){var e=d.split("=");2===e.length&&(b[e[0]]=a(e[1]));return b};h.parseFmtpConfig=function(a){return a.split(/\;\s?/).reduce(e,{})};
h.parsePayloads=function(a){return a.split(" ").map(Number)};h.parseRemoteCandidates=function(b){var d=[];b=b.split(" ").map(a);for(var e=0;e<b.length;e+=3)d.push({component:b[e],ip:b[e+1],port:b[e+2]});return d}},{"./grammar":37}],40:[function(g,m,h){var a=g("./grammar"),b=/%[sdv%]/g,d=function(a){var c=1,d=arguments,e=d.length;return a.replace(b,function(a){if(c>=e)return a;var b=d[c];c+=1;switch(a){case "%%":return"%";case "%s":return String(b);case "%d":return Number(b);case "%v":return""}})},
e=function(a,b,c){var e=b.format instanceof Function?b.format(b.push?c:c[b.name]):b.format;a=[a+"="+e];if(b.names)for(e=0;e<b.names.length;e+=1){var f=b.names[e];b.name?a.push(c[b.name][f]):a.push(c[b.names[e]])}else a.push(c[b.name]);return d.apply(null,a)},c="vosiuepcbtrza".split(""),f=["i","c","b","a"];m.exports=function(b,d){d=d||{};null==b.version&&(b.version=0);null==b.name&&(b.name=" ");b.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var g=d.innerOrder||f,h=[];(d.outerOrder||
c).forEach(function(c){a[c].forEach(function(a){a.name in b&&null!=b[a.name]?h.push(e(c,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){h.push(e(c,a,b))})})});b.media.forEach(function(b){h.push(e("m",a.m[0],b));g.forEach(function(c){a[c].forEach(function(a){a.name in b&&null!=b[a.name]?h.push(e(c,a,b)):a.push in b&&null!=b[a.push]&&b[a.push].forEach(function(b){h.push(e(c,a,b))})})})});return h.join("\r\n")+"\r\n"}},{"./grammar":37}],41:[function(g,m,h){(function(a,b){"object"===
typeof h?m.exports=b():"function"===typeof define&&define.amd?define(b):a.printStackTrace=b()})(this,function(){function a(b){b=b||{guess:!0};var d=b.e||null,e=!!b.guess,c=b.mode||null;b=new a.implementation;d=b.run(d,c);return e?b.guessAnonymousFunctions(d):d}a.implementation=function(){};a.implementation.prototype={run:function(a,d){a=a||this.createException();d=d||this.mode(a);return"other"===d?this.other(arguments.callee):this[d](a)},createException:function(){try{this.undef()}catch(a){return a}},
mode:function(a){return"undefined"!==typeof window&&-1<window.navigator.userAgent.indexOf("PhantomJS")?"phantomjs":a.arguments&&a.stack?"chrome":a.stack&&a.sourceURL?"safari":a.stack&&a.number?"ie":a.stack&&a.fileName?"firefox":a.message&&a["opera#sourceloc"]?!a.stacktrace||-1<a.message.indexOf("\n")&&a.message.split("\n").length>a.stacktrace.split("\n").length?"opera9":"opera10a":a.message&&a.stack&&a.stacktrace?0>a.stacktrace.indexOf("called from line")?"opera10b":"opera11":a.stack&&!a.fileName?
"chrome":"other"},instrumentFunction:function(b,d,e){b=b||window;var c=b[d];b[d]=function(){e.call(this,a().slice(4));return b[d]._instrumented.apply(this,arguments)};b[d]._instrumented=c},deinstrumentFunction:function(a,d){a[d].constructor===Function&&a[d]._instrumented&&a[d]._instrumented.constructor===Function&&(a[d]=a[d]._instrumented)},chrome:function(a){return(a.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,
"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(a){return a.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,
"{anonymous}($1)@").split("\n")},opera11:function(a){var d=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;a=a.stacktrace.split("\n");for(var e=[],c=0,f=a.length;c<f;c+=2){var g=d.exec(a[c]);if(g){var h=g[4]+":"+g[1]+":"+g[2],g=g[3]||"global code",g=g.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}");e.push(g+"@"+h+" -- "+a[c+1].replace(/^\s+/,""))}}return e},opera10b:function(a){var d=/^(.*)@(.+):(\d+)$/;a=a.stacktrace.split("\n");for(var e=[],c=0,f=
a.length;c<f;c++){var g=d.exec(a[c]);g&&e.push((g[1]?g[1]+"()":"global code")+"@"+g[2]+":"+g[3])}return e},opera10a:function(a){var d=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;a=a.stacktrace.split("\n");for(var e=[],c=0,f=a.length;c<f;c+=2){var g=d.exec(a[c]);g&&e.push((g[3]||"{anonymous}")+"()@"+g[2]+":"+g[1]+" -- "+a[c+1].replace(/^\s+/,""))}return e},opera9:function(a){var d=/Line (\d+).*script (?:in )?(\S+)/i;a=a.message.split("\n");for(var e=[],c=2,f=a.length;c<f;c+=2){var g=
d.exec(a[c]);g&&e.push("{anonymous}()@"+g[2]+":"+g[1]+" -- "+a[c+1].replace(/^\s+/,""))}return e},phantomjs:function(a){var d=/(\S+) \((\S+)\)/i;a=a.stack.split("\n");for(var e=[],c=1,f=a.length;c<f;c++){a[c]=a[c].replace(/^\s+at\s+/gm,"");var g=d.exec(a[c]);g?e.push(g[1]+"()@"+g[2]):e.push("{anonymous}()@"+a[c])}return e},other:function(a){for(var d=/function(?:\s+([\w$]+))?\s*\(/,e=[],c,f,g=Array.prototype.slice;a&&10>e.length;){c=d.test(a.toString())?RegExp.$1||"{anonymous}":"{anonymous}";try{f=
g.call(a.arguments||[])}catch(h){f=["Cannot access arguments: "+h]}e[e.length]=c+"("+this.stringifyArguments(f)+")";try{a=a.caller}catch(k){e[e.length]="Cannot access caller: "+k;break}}return e},stringifyArguments:function(a){for(var d=[],e=Array.prototype.slice,c=0;c<a.length;++c){var f=a[c];void 0===f?d[c]="undefined":null===f?d[c]="null":f.constructor&&(d[c]=f.constructor===Array?3>f.length?"["+this.stringifyArguments(f)+"]":"["+this.stringifyArguments(e.call(f,0,1))+"..."+this.stringifyArguments(e.call(f,
-1))+"]":f.constructor===Object?"#object":f.constructor===Function?"#function":f.constructor===String?'"'+f+'"':f.constructor===Number?f:"?")}return d.join(",")},sourceCache:{},ajax:function(a){var d=this.createXMLHTTPObject();if(d)try{return d.open("GET",a,!1),d.send(null),d.responseText}catch(e){}return""},createXMLHTTPObject:function(){for(var a,d=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},
function(){return new ActiveXObject("Microsoft.XMLHTTP")}],e=0;e<d.length;e++)try{return a=d[e](),this.createXMLHTTPObject=d[e],a}catch(c){}},isSameDomain:function(a){return"undefined"!==typeof location&&-1!==a.indexOf(location.hostname)},getSource:function(a){a in this.sourceCache||(this.sourceCache[a]=this.ajax(a).split("\n"));return this.sourceCache[a]},guessAnonymousFunctions:function(a){for(var d=0;d<a.length;++d){var e=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,c=a[d],f=/\{anonymous\}\(.*\)@(.*)/.exec(c);
if(f){var g=e.exec(f[1]);g&&(e=g[1],f=g[2],g=g[3]||0,e&&this.isSameDomain(e)&&f&&(e=this.guessAnonymousFunction(e,f,g),a[d]=c.replace("{anonymous}",e)))}}return a},guessAnonymousFunction:function(a,d,e){var c;try{c=this.findFunctionName(this.getSource(a),d)}catch(f){c="getSource failed with url: "+a+", exception: "+f.toString()}return c},findFunctionName:function(a,d){for(var e=/function\s+([^(]*?)\s*\(([^)]*)\)/,c=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,f=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,
g="",h,k=Math.min(d,20),m,p=0;p<k;++p)if(h=a[d-p-1],m=h.indexOf("//"),0<=m&&(h=h.substr(0,m)),h)if(g=h+g,(h=c.exec(g))&&h[1]||(h=e.exec(g))&&h[1]||(h=f.exec(g))&&h[1])return h[1];return"(?)"}};return a})},{}],42:[function(g,m,h){function a(a,e,c){return e?new b(a,e):new b(a)}g=function(){return this}();var b=g.WebSocket||g.MozWebSocket;m.exports=b?a:null;b&&(a.prototype=b.prototype)},{}],43:[function(g,m,h){h.XMLHttpRequest=XMLHttpRequest},{}]},{},[1]);
